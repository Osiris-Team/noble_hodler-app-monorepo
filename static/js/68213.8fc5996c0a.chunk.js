"use strict";(self.webpackChunkweb=self.webpackChunkweb||[]).push([[68213],{461483:(e,t,s)=>{s.d(t,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var n=s(586330),i=s(514041),r=s(908867),o=s(490343),a=s(610421),l=s(254491),c=s(287007),u=s(831085);const __WEBPACK_DEFAULT_EXPORT__=function({oldEncodedPassword:e,onUpdateRes:t}){var s,[d,g]=(0,i.useState)(!1),f=(0,r.A)(),p=(0,i.useCallback)((s=(0,n.A)((function*(s){g(!0);try{if(s.confirmPassword!==s.password)return void o.Toast.error({title:f.formatMessage({id:l.ETranslations.auth_error_password_not_match})});var n=yield a.A.servicePassword.encodeSensitiveText({text:s.password}),i=yield a.A.servicePassword.updatePassword(e,n);t(i),o.Toast.success({title:f.formatMessage({id:l.ETranslations.auth_password_set})})}catch(e){o.Toast.error({title:f.formatMessage({id:l.ETranslations.auth_new_password_same_as_old})})}g(!1)})),function(e){return s.apply(this,arguments)}),[e,t,f]);return(0,u.jsx)(c.A,{loading:d,onSetupPassword:p,confirmBtnText:f.formatMessage({id:l.ETranslations.global_confirm})})}},447479:(e,t,s)=>{s.d(t,{I:()=>useOptions});var n=s(514041),i=s(908867),r=s(507026),o=s(254491);function useOptions(){var e=(0,i.A)();return(0,n.useMemo)((function(){return[{title:e.formatMessage({id:o.ETranslations.global_always}),value:r.J.Always},{title:e.formatMessage({id:o.ETranslations.settings_if_away_for_1_min}),value:r.J.Minute},{title:e.formatMessage({id:o.ETranslations.settings_if_away_for_5_mins}),value:r.J.Minute5},{title:e.formatMessage({id:o.ETranslations.settings_if_away_for_30_mins}),value:r.J.Minute30},{title:e.formatMessage({id:o.ETranslations.settings_if_away_for_1_hr}),value:r.J.Hour},{title:e.formatMessage({id:o.ETranslations.settings_if_away_for_4_hrs}),value:r.J.Hour4},{title:e.formatMessage({id:o.ETranslations.global_never}),value:r.J.Never}]}),[e])}},415902:(e,t,s)=>{s.d(t,{_:()=>StartTimePanel});var n=s(490343),i=s(318003),r=s(831085);function StartTimePanel(){var{jsBundleLoadedTime:e,fpTime:t}=(0,i.useMeasureTime)();return(0,r.jsxs)(n.YStack,{children:[(0,r.jsxs)(n.SizableText,{children:["JS Bundle 加载执行时长: ",e]}),(0,r.jsxs)(n.SizableText,{children:["界面渲染时长: ",t-e]}),(0,r.jsxs)(n.SizableText,{children:["启动总时长: ",t]})]})}},460627:(e,t,s)=>{s.d(t,{u:()=>l});var n,i=s(586330),r=s(610421),o=s(157572),a=s(520202),l=(n=(0,i.A)((function*(e){var t=`${e}.txt`;o.U.setting.device.logDeviceInfo(),yield(0,a.of)(1e3);var s=yield r.A.serviceLogger.getAllMsg(),n=document.createElement("a"),i=new Blob(s,{type:"text/plain",endings:"native"});n.href=URL.createObjectURL(i),n.download=t,document.body.appendChild(n),n.click()})),function exportLogs(e){return n.apply(this,arguments)})},768213:(e,t,s)=>{s.r(t),s.d(t,{default:()=>SettingListModal});var n,i,r,o=s(586330),a=s(514041),l=s(654266),c=s(908867),u=s(490343),d=s(610421),g=s(164208),f=s(259227),p=s(713132),m=s(726130),h=s(254491),b=s(663522),j=s(117746),x=0,v=!1,S=(i=(0,o.A)((function*(){return new Promise((function(e,t){u.Dialog.show({title:"Danger Zone",tone:"warning",icon:"ErrorOutline",description:"Are you sure you want to enable developer-related features?",dismissOnOverlayPress:!1,confirmButtonProps:{testID:"confirm-button"},onConfirm:e,onCancel:function(e){e(),t(new Error("User canceled"))}})}))})),function showPromoteDialog(){return i.apply(this,arguments)}),y=(r=(0,o.A)((function*(e){var t=new Date;if(0===x&&e(),!v&&(void 0===n||Math.round(t.getTime()-n.getTime())>5e3?(n=t,x=0):x+=1,x>=9)){v=!0;try{yield S(),yield d.A.servicePassword.promptPasswordVerify({dialogProps:{confirmButtonProps:{testID:"confirm-button"},description:"Danger Zone: Are you sure you want to enable developer-related features?",dismissOnOverlayPress:!1}}),yield d.A.serviceDevSetting.switchDevMode(!0)}catch(e){}finally{x=0,v=!1}}})),function handleOpenDevMode(e){return r.apply(this,arguments)}),_=s(791088),P=s(498356),w=s(392097),A=s(324586),D=s(831085);function ownKeys(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,n)}return s}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(s),!0).forEach((function(t){(0,A.A)(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):ownKeys(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}var Section=function({title:e,titleProps:t,children:s}){return(0,D.jsxs)(u.Stack,{children:[(0,D.jsx)(u.SizableText,_objectSpread(_objectSpread({size:"$headingSm",paddingHorizontal:"$4",paddingBottom:"$2",paddingTop:"$5",color:"$textSubdued"},t),{},{children:e})),(0,D.jsx)(u.Stack,{children:s})]})},HardwareBridgeListItems=function(){var e=(0,a.useCallback)((function(){(0,j.Dr)(m.By)}),[]),t=(0,c.A)();return(0,D.jsx)(D.Fragment,{children:(0,D.jsx)(_.c,{onPress:e,icon:"ApiConnectionOutline",title:t.formatMessage({id:h.ETranslations.settings_hardware_bridge_status}),children:(0,D.jsx)(_.c.IconButton,{disabled:!0,icon:"ArrowTopRightOutline",iconProps:{color:"$iconActive"}})})})},AdvancedSection=function(){var e=(0,c.A)(),t=(0,P.A)(),s=(0,a.useCallback)((function(){t.push(w.Pj.SettingAccountDerivationModal)}),[t]),n=(0,a.useCallback)((function(){t.push(w.Pj.SettingCustomRPC)}),[t]);return(0,D.jsxs)(Section,{title:e.formatMessage({id:h.ETranslations.global_advanced}),children:[(0,D.jsx)(_.c,{onPress:n,icon:"BezierNodesOutline",title:e.formatMessage({id:h.ETranslations.custom_rpc_title}),drillIn:!0}),(0,D.jsx)(_.c,{onPress:s,icon:"BranchesOutline",title:e.formatMessage({id:h.ETranslations.settings_account_derivation_path}),drillIn:!0}),(0,D.jsx)(HardwareBridgeListItems,{})]})},T=s(768262),E=s(265767),O=s(536039),C=(s(567807),s(215341)),I=s(281464),M=s(839850),k=["title","onPress","copyable"];function SectionPressItem_ownKeys(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,n)}return s}function SectionPressItem(e){var{title:t,onPress:s,copyable:n}=e,i=(0,M.A)(e,k),{copyText:r}=(0,u.useClipboard)(),o=(0,a.useCallback)((function(){r(t)}),[r,t]);return(0,D.jsx)(_.c,function SectionPressItem_objectSpread(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?SectionPressItem_ownKeys(Object(s),!0).forEach((function(t){(0,A.A)(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):SectionPressItem_ownKeys(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}({drillIn:!0,onPress:n?o:s,title:t,titleProps:{color:"$textCritical"}},i))}var AddressBookDevSetting=function(){var e=(0,a.useCallback)((0,o.A)((function*(){u.Dialog.show({title:"Tamper Address Book",description:"This is a feature specific to development environments. Function used to simulate address data being tampered with",confirmButtonProps:{variant:"destructive"},onConfirm:function(){d.A.serviceAddressBook.__dangerTamperVerifyHashForTest()}})})),[]);return(0,D.jsx)(SectionPressItem,{title:"Hack Address Book",testID:"temper-address-book",onPress:e})};function CrashDevSettings(){var[e,t]=(0,a.useState)({a:{b:{c:"text"}}});return(0,D.jsx)(SectionPressItem,{title:`Crash Test ${e.a.b.c}`,onPress:function(){t("")}})}function NotificationDevSettings_ownKeys(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,n)}return s}function NotificationDevSettings_objectSpread(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?NotificationDevSettings_ownKeys(Object(s),!0).forEach((function(t){(0,A.A)(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):NotificationDevSettings_ownKeys(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function NotificationSectionFieldItem({name:e,title:t,titleProps:s={color:"$textCritical"},children:n,onValueChange:i,testID:r=""}){var[l,c]=(0,f.useNotificationsDevSettingsPersistAtom)(),u=a.Children.only(n),d=e?l?.[e]:"",g=(0,a.useCallback)(function(){var t=(0,o.A)((function*(t){e&&(c((function(s){return NotificationDevSettings_objectSpread(NotificationDevSettings_objectSpread({},s),{},{[e]:t})})),i?.(t))}));return function(e){return t.apply(this,arguments)}}(),[e,i,c]),p=u?(0,a.cloneElement)(u,NotificationDevSettings_objectSpread(NotificationDevSettings_objectSpread({},u.props),{},{value:d,onChange:g})):null;return(0,D.jsx)(_.c,{title:t,titleProps:s,testID:r,children:p})}function NotificationDevSettings(){var[,e]=(0,f.useNotificationsAtom)();return(0,D.jsxs)(u.Stack,{children:[(0,D.jsx)(NotificationSectionFieldItem,{name:"showMessagePushSource",title:"显示消息推送来源",children:(0,D.jsx)(u.Switch,{size:u.ESwitchSize.small})}),(0,D.jsx)(NotificationSectionFieldItem,{name:"disabledWebSocket",title:"禁用 WebSocket (重启生效）",children:(0,D.jsx)(u.Switch,{size:u.ESwitchSize.small})}),(0,D.jsx)(NotificationSectionFieldItem,{name:"disabledJPush",title:"禁用 JPush (重启生效）",children:(0,D.jsx)(u.Switch,{size:u.ESwitchSize.small})}),(0,D.jsx)(u.Button,{onPress:function(){e((function(e){return NotificationDevSettings_objectSpread(NotificationDevSettings_objectSpread({},e),{},{firstTimeGuideOpened:!1})})),u.Toast.success({title:"重置成功",message:"首页消息中心入口，点击后将提示权限引导，而不是进入消息列表"})},children:"重置首次通知权限引导提醒"}),(0,D.jsx)(u.Button,{onPress:function(){e((function(e){return NotificationDevSettings_objectSpread(NotificationDevSettings_objectSpread({},e),{},{lastRegisterTime:void 0})})),u.Toast.success({title:"重置成功",message:"进入首页将再次发起 register 请求"})},children:"重置每日同步账户时间戳"})]})}function SectionFieldItem_ownKeys(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,n)}return s}function SectionFieldItem_objectSpread(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?SectionFieldItem_ownKeys(Object(s),!0).forEach((function(t){(0,A.A)(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):SectionFieldItem_ownKeys(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function SectionFieldItem({name:e,title:t,subtitle:s,children:n,onValueChange:i,titleProps:r={color:"$textCritical"},testID:l="",onBeforeValueChange:c}){var[u]=(0,f.useDevSettingsPersistAtom)(),g=a.Children.only(n),p=e?u?.settings?.[e]:"",m=(0,a.useCallback)(function(){var t=(0,o.A)((function*(t){e&&(c&&(yield c()),yield d.A.serviceDevSetting.updateDevSetting(e,t),i?.(t))}));return function(e){return t.apply(this,arguments)}}(),[e,c,i]),h=g?(0,a.cloneElement)(g,SectionFieldItem_objectSpread(SectionFieldItem_objectSpread({},g.props),{},{value:p,onChange:m})):null;return(0,D.jsx)(_.c,{title:t,subtitle:s,titleProps:r,testID:l,children:h})}var F=s(415902);function DevSettingsSection_ownKeys(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,n)}return s}function DevSettingsSection_objectSpread(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?DevSettingsSection_ownKeys(Object(s),!0).forEach((function(t){(0,A.A)(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):DevSettingsSection_ownKeys(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function showDevOnlyPasswordDialog({title:e,description:t,onConfirm:s,confirmButtonProps:n}){u.Dialog.show({title:e,description:t,confirmButtonProps:DevSettingsSection_objectSpread({variant:"destructive"},n),renderContent:(0,D.jsx)(u.Dialog.Form,{formProps:{values:{password:""}},children:(0,D.jsx)(u.Dialog.FormField,{name:"password",rules:{required:{value:!0,message:"password is required."}},children:(0,D.jsx)(u.Input,{testID:"dev-only-password",placeholder:"devOnlyPassword"})})}),onConfirm:function(){var e=(0,o.A)((function*({getForm:e}){var t=e();if(t){yield t.trigger();var{password:n}=t.getValues()||{};if(!(0,O.tB)(n))return;var i={$$devOnlyPassword:n};yield s(i)}}));return function onConfirm(t){return e.apply(this,arguments)}}()})}var DevSettingsSection=function(){var[e]=(0,f.useSettingsPersistAtom)(),[t]=(0,E.LA)(),s=(0,c.A)(),n=(0,P.A)(),{copyText:i}=(0,u.useClipboard)(),r=(0,a.useCallback)((function(){u.Dialog.show({title:"关闭开发者模式",onConfirm:function(){d.A.serviceDevSetting.switchDevMode(!1)}})}),[]);(0,a.useCallback)((function(){showDevOnlyPasswordDialog({title:"Danger Zone: Open Chrome DevTools",onConfirm:function(){var e=(0,o.A)((function*(){window?.desktopApi.changeDevTools(!0)}));return function onConfirm(){return e.apply(this,arguments)}}()})}),[]);return t.enabled?(0,D.jsxs)(Section,{title:s.formatMessage({id:h.ETranslations.global_dev_mode}),titleProps:{color:"$textCritical"},children:[(0,D.jsx)(SectionPressItem,{title:"关闭开发者模式",onPress:r}),null,(0,D.jsx)(SectionPressItem,{copyable:!0,title:e.instanceId,subtitle:"InstanceId"}),b.Ay.githubSHA?(0,D.jsx)(SectionPressItem,{copyable:!0,title:b.Ay.githubSHA,subtitle:"BuildHash"}):null,(0,D.jsx)(SectionFieldItem,{name:"enableTestEndpoint",title:"启用 OneKey 测试网络节点",subtitle:t.settings?.enableTestEndpoint?m.Nv:m.E5,onBeforeValueChange:(0,o.A)((function*(){try{yield d.A.serviceNotification.unregisterClient()}catch(e){}})),onValueChange:function(e){setTimeout((function(){d.A.serviceApp.restartApp()}),300)},children:(0,D.jsx)(u.Switch,{size:u.ESwitchSize.small})}),(0,D.jsx)(SectionFieldItem,{name:"showDevOverlayWindow",title:"开发者悬浮窗",subtitle:"始终悬浮于全局的开发调试工具栏",testID:"show-dev-overlay",children:(0,D.jsx)(u.Switch,{size:u.ESwitchSize.small})}),(0,D.jsx)(SectionFieldItem,{name:"alwaysSignOnlySendTx",title:"始终只签名不广播",testID:"always-sign-only-send-tx",children:(0,D.jsx)(u.Switch,{size:u.ESwitchSize.small})}),(0,D.jsx)(SectionFieldItem,{name:"showDevExportPrivateKey",title:"首页导出私钥临时入口",subtitle:"",testID:"export-private-key",children:(0,D.jsx)(u.Switch,{size:u.ESwitchSize.small})}),(0,D.jsx)(SectionFieldItem,{name:"showAllStakingProviders",title:"显示所有 Staking 提供商",testID:"show-all-staking-providers",children:(0,D.jsx)(u.Switch,{size:u.ESwitchSize.small})}),(0,D.jsx)(SectionPressItem,{title:"Export Accounts Data",onPress:function(){var e;showDevOnlyPasswordDialog({title:"Danger Zone",description:"Export Accounts Data",onConfirm:(e=(0,o.A)((function*(e){u.Dialog.cancel({title:"Export Accounts Data",renderContent:(0,D.jsx)(u.YStack,{children:(0,D.jsx)(SectionPressItem,{title:"Export Accounts Data",onPress:(0,o.A)((function*(){var t=yield d.A.serviceE2E.exportAllAccountsData(e);i((0,I.JB)(t))}))})})})})),function onConfirm(t){return e.apply(this,arguments)})})}}),(0,D.jsx)(SectionPressItem,{title:"FirmwareUpdateDevSettings",testID:"firmware-update-dev-settings-menu",onPress:function(){n.push(w.Pj.SettingDevFirmwareUpdateModal)}}),(0,D.jsx)(SectionPressItem,{title:"NotificationDevSettings",onPress:function(){u.Dialog.cancel({title:"NotificationDevSettings",renderContent:(0,D.jsx)(NotificationDevSettings,{})})}}),null,(0,D.jsx)(SectionPressItem,{title:"V4MigrationDevSettings",testID:"v4-migration-dev-settings-menu",onPress:function(){u.Dialog.show({title:"!!!!  Danger Zone: Clear all your data",description:"This is a feature specific to development environments. Function used to erase all data in the app.",confirmButtonProps:{variant:"destructive"},onConfirm:function(){n.push(w.Pj.SettingDevV4MigrationModal)}})}}),(0,D.jsx)(SectionPressItem,{title:"Clear App Data (E2E release only)",testID:"clear-data-menu",onPress:function(){var e;showDevOnlyPasswordDialog({title:"Danger Zone: Clear all your data",confirmButtonProps:{variant:"destructive",testID:"clear-double-confirm"},description:"This is a feature specific to development environments.\n                  Function used to erase all data in the app.",onConfirm:(e=(0,o.A)((function*(e){u.Dialog.cancel({title:"Clear App Data (E2E release only)",renderContent:(0,D.jsxs)(u.YStack,{children:[(0,D.jsx)(SectionPressItem,{title:"Clear Discovery Data",testID:"clear-discovery-data",onPress:(0,o.A)((function*(){yield d.A.serviceE2E.clearDiscoveryPageData(e),u.Toast.success({title:"Success"})}))}),(0,D.jsx)(SectionPressItem,{title:"Clear Address Book Data",testID:"clear-address-book-data",onPress:(0,o.A)((function*(){yield d.A.serviceE2E.clearAddressBook(e),u.Toast.success({title:"Success"})}))}),(0,D.jsx)(SectionPressItem,{title:"Clear Wallets & Accounts Data",testID:"clear-wallets-data",onPress:(0,o.A)((function*(){yield d.A.serviceE2E.clearWalletsAndAccounts(e),u.Toast.success({title:"Success"})}))}),(0,D.jsx)(SectionPressItem,{title:"Clear Password",testID:"clear-password",onPress:(0,o.A)((function*(){yield d.A.serviceE2E.clearPassword(e),u.Toast.success({title:"Success"})}))}),(0,D.jsx)(SectionPressItem,{title:"Clear History",testID:"clear-history",onPress:(0,o.A)((function*(){yield d.A.serviceE2E.clearHistoryData(e),u.Toast.success({title:"Success"})}))}),(0,D.jsx)(SectionPressItem,{title:"Clear Settings",testID:"clear-settings",onPress:(0,o.A)((function*(){yield d.A.serviceE2E.clearSettings(e),u.Toast.success({title:"Success"})}))}),(0,D.jsx)(SectionPressItem,{title:"Clear Wallet Connect Sessions",testID:"wallet-connect-session",onPress:(0,o.A)((function*(){yield d.A.serviceWalletConnect.disconnectAllSessions(),u.Toast.success({title:"Success"})}))})]})})})),function onConfirm(t){return e.apply(this,arguments)})})}}),(0,D.jsx)(SectionPressItem,{title:"Startup Time(ms)",onPress:function(){u.Dialog.cancel({title:"Startup Time(ms)",renderContent:(0,D.jsx)(F._,{})})}}),(0,D.jsx)(SectionPressItem,{title:"Reset Spotlight",subtitle:"Will reset after 5 seconds.",onPress:function(){setTimeout((function(){d.A.serviceSpotlight.reset()}),5e3)}}),b.Ay.isNativeAndroid?(0,D.jsx)(SectionPressItem,{copyable:!0,title:"Android Channel: "}):null,null,(0,D.jsx)(_.c,{drillIn:!0,onPress:function(){(0,C.RI)(),window.location.reload()},title:`Switch web mode: ${(0,C.uP)()?"dapp":"wallet"} mode`,titleProps:{color:"$textCritical"}}),(0,D.jsx)(AddressBookDevSetting,{}),(0,D.jsx)(CrashDevSettings,{})]}):null},B=s(603465),N=s(788316),ThemeListItem=function(){var[{theme:e}]=(0,f.useSettingsPersistAtom)(),{setFreezeOnBlur:t}=(0,a.useContext)(B.k),s=(0,c.A)(),n=(0,a.useMemo)((function(){return[{label:s.formatMessage({id:h.ETranslations.global_auto}),description:s.formatMessage({id:h.ETranslations.global_follow_the_system}),value:"system"},{label:s.formatMessage({id:h.ETranslations.global_light}),value:"light"},{label:s.formatMessage({id:h.ETranslations.global_dark}),value:"dark"}]}),[s]),i=(0,a.useCallback)(function(){var e=(0,o.A)((function*(e){t(!1),yield d.A.serviceSetting.setTheme(e),t(!0)}));return function(t){return e.apply(this,arguments)}}(),[t]);return(0,D.jsx)(u.Select,{offset:{mainAxis:-4,crossAxis:-10},title:s.formatMessage({id:h.ETranslations.settings_theme}),items:n,value:e,onChange:i,placement:"bottom-end",renderTrigger:function({label:e}){return(0,D.jsx)(_.c,{userSelect:"none",icon:"PaletteOutline",title:s.formatMessage({id:h.ETranslations.settings_theme}),children:(0,D.jsxs)(u.XStack,{children:[(0,D.jsx)(_.c.Text,{primary:e,align:"right"}),(0,D.jsx)(_.c.DrillIn,{ml:"$1.5",name:"ChevronDownSmallSolid"})]})})}})},LanguageListItem=function(){var e=(0,N._)(),t=(0,c.A)(),[{locale:s,currencyInfo:n}]=(0,f.useSettingsPersistAtom)(),i=(0,a.useCallback)(function(){var e=(0,o.A)((function*(e){yield d.A.serviceSetting.setLocale(e),setTimeout((function(){d.A.serviceApp.restartApp()}),0)}));return function(t){return e.apply(this,arguments)}}(),[]);return(0,D.jsx)(u.Select,{offset:{mainAxis:-4,crossAxis:-10},title:t.formatMessage({id:h.ETranslations.global_language}),items:e,value:s,onChange:i,placement:"bottom-end",floatingPanelProps:{maxHeight:280},sheetProps:{snapPoints:[80],snapPointsMode:"percent"},renderTrigger:function({label:e}){return(0,D.jsx)(_.c,{userSelect:"none",icon:"GlobusOutline",title:t.formatMessage({id:h.ETranslations.global_language}),children:(0,D.jsxs)(u.XStack,{children:[(0,D.jsx)(_.c.Text,{primary:e,align:"right"}),(0,D.jsx)(_.c.DrillIn,{ml:"$1.5",name:"ChevronDownSmallSolid"})]})})}})},CurrencyListItem=function(){var e,t=(0,P.A)(),s=(0,a.useCallback)((function(){t.push(w.Pj.SettingCurrencyModal)}),[t]),n=(0,c.A)(),[i]=(0,f.useSettingsPersistAtom)(),r=null!=(e=i.currencyInfo?.id)?e:"";return(0,D.jsx)(_.c,{userSelect:"none",icon:"DollarOutline",title:n.formatMessage({id:h.ETranslations.settings_default_currency}),drillIn:!0,onPress:s,children:(0,D.jsx)(_.c.Text,{primary:r.toUpperCase(),align:"right"})})},NotificationsListItem=function(){var e=(0,P.A)(),t=(0,c.A)(),s=(0,a.useCallback)((function(){e.push(w.Pj.SettingNotifications)}),[e]);return(0,D.jsx)(_.c,{icon:"BellOutline",title:t.formatMessage({id:h.ETranslations.global_notifications}),drillIn:!0,onPress:s})},PreferenceSection=function(){var e=(0,c.A)();return(0,D.jsxs)(Section,{title:e.formatMessage({id:h.ETranslations.global_preferences}),children:[(0,D.jsx)(CurrencyListItem,{}),(0,D.jsx)(LanguageListItem,{}),(0,D.jsx)(ThemeListItem,{}),(0,D.jsx)(NotificationsListItem,{})]})},$=s(536612),z=s(390334),UrlExternalListItem=function({icon:e,title:t,url:s,drillIn:n}){var i=(0,a.useCallback)((function(){(0,j.Dr)(s)}),[s]);return(0,D.jsx)(_.c,{onPress:i,icon:e,title:t,drillIn:n})},CustomNetworkConfigItem=function(){var e=(0,c.A)(),t=(0,P.A)(),s=(0,a.useCallback)((function(){t.navigate(w.Pj.SettingExportCustomNetworkConfig)}),[t]);return(0,D.jsx)(_.c,{onPress:s,icon:"FileDownloadOutline",title:e.formatMessage({id:h.ETranslations.settings_export_network_config_label}),drillIn:!0})},L=b.Ay.isNativeAndroidGooglePlay||b.Ay.isNativeIOS,RateAppItem=function(){var e=(0,c.A)(),t=(0,a.useCallback)((function(){b.Ay.isNativeAndroidGooglePlay?(0,j.Dr)(m.M6):b.Ay.isNativeIOS&&(0,j.Dr)(m.nw)}),[e]);return L?(0,D.jsx)(_.c,{onPress:t,icon:"StarOutline",title:e.formatMessage({id:h.ETranslations.settings_rate_app}),drillIn:!0}):null},H=s(460627),StateLogsItem=function(){var e=(0,c.A)(),{copyText:t}=(0,u.useClipboard)(),s=(0,a.useCallback)((function(){u.Dialog.show({icon:"FileDownloadOutline",title:e.formatMessage({id:h.ETranslations.settings_export_state_logs}),renderContent:(0,D.jsxs)(u.Stack,{children:[(0,D.jsx)(u.SizableText,{size:"$bodyLg",children:e.formatMessage({id:h.ETranslations.settings_logs_do_not_include_sensitive_data})}),(0,D.jsx)(u.Stack,{h:"$5"}),(0,D.jsx)(u.SizableText,{size:"$bodyLg",children:e.formatMessage({id:h.ETranslations.settings_export_state_logs_desc},{email:(0,D.jsx)(u.SizableText,{size:"$bodyLg",textDecorationLine:"underline",onPress:function(){return t("hi@onekey.so")},children:"hi@onekey.so"})})})]}),confirmButtonProps:{variant:"primary"},onConfirmText:e.formatMessage({id:h.ETranslations.global_export}),onConfirm:function(){var e=(new Date).toISOString().replace(/[-:.]/g,"");(0,H.u)(`OneKeyLogs-${e}`)}})}),[t,e]);return(0,D.jsx)(_.c,{icon:"FileDownloadOutline",onPress:s,title:e.formatMessage({id:h.ETranslations.settings_export_state_logs}),drillIn:!0})};function ListVersionItem(){var e=(0,c.A)(),t=(0,$.SX)(),s=(0,a.useCallback)((function(){t.toUpdatePreviewPage()}),[t]);return t.isNeedUpdate?(0,D.jsx)(_.c,{onPress:s,icon:"InfoCircleOutline",iconProps:{color:"$textInfo"},title:e.formatMessage({id:h.ETranslations.settings_app_update_available}),titleProps:{color:"$textInfo"},drillIn:!0,children:(0,D.jsx)(_.c.Text,{primary:(0,D.jsx)(u.Badge,{badgeType:"info",badgeSize:"lg",children:t.data.latestVersion}),align:"right"})}):(0,D.jsx)(_.c,{onPress:t.onViewReleaseInfo,icon:"InfoCircleOutline",title:e.formatMessage({id:h.ETranslations.settings_whats_new}),drillIn:!0,children:(0,D.jsx)(_.c.Text,{primary:b.Ay.version,align:"right"})})}var ResourceSection=function(){var e=(0,z.P)({path:"articles/360002014776"}),t=(0,z.P)({path:"articles/360002003315"}),s=(0,z.P)({path:"requests/new"}),n=(0,z.P)({path:""}),i=(0,c.A)();return(0,D.jsxs)(Section,{title:i.formatMessage({id:h.ETranslations.settings_resources}),children:[(0,D.jsx)(ListVersionItem,{}),(0,D.jsx)(UrlExternalListItem,{icon:"HelpSupportOutline",title:i.formatMessage({id:h.ETranslations.settings_help_center}),url:n,drillIn:!0}),(0,D.jsx)(UrlExternalListItem,{icon:"EditOutline",title:i.formatMessage({id:h.ETranslations.settings_submit_request}),url:s,drillIn:!0}),(0,D.jsx)(RateAppItem,{}),(0,D.jsx)(UrlExternalListItem,{icon:"PeopleOutline",title:i.formatMessage({id:h.ETranslations.settings_user_agreement}),url:e,drillIn:!0}),(0,D.jsx)(UrlExternalListItem,{icon:"FileTextOutline",title:i.formatMessage({id:h.ETranslations.settings_privacy_policy}),url:t,drillIn:!0}),(0,D.jsx)(CustomNetworkConfigItem,{}),(0,D.jsx)(StateLogsItem,{})]})},R=s(247424),V=s(215189),K=s(461483),U=s(456628),W=s(15159),J=s(447479),G=s(318822),ClearCacheOnAppContent=function(){var e=(0,c.A)();return(0,D.jsx)(u.Dialog.Form,{formProps:{defaultValues:{tokenAndNFT:!0,transactionHistory:!0,swapHistory:!0,browserCache:!0,appUpdateCache:!0,browserHistory:!1,connectSites:!1,signatureRecord:!1,customToken:!1,customRpc:!1}},children:(0,D.jsxs)(u.Stack,{children:[(0,D.jsx)(u.Dialog.FormField,{name:"tokenAndNFT",children:(0,D.jsx)(u.Checkbox,{label:e.formatMessage({id:h.ETranslations.settings_token_nft_data})})}),(0,D.jsx)(u.Dialog.FormField,{name:"transactionHistory",children:(0,D.jsx)(u.Checkbox,{label:e.formatMessage({id:h.ETranslations.settings_transaction_history})})}),(0,D.jsx)(u.Dialog.FormField,{name:"swapHistory",children:(0,D.jsx)(u.Checkbox,{label:e.formatMessage({id:h.ETranslations.settings_swap_history})})}),(0,D.jsx)(u.Dialog.FormField,{name:"browserCache",children:(0,D.jsx)(u.Checkbox,{label:e.formatMessage({id:h.ETranslations.settings_browser_cache})})}),(0,D.jsx)(u.Dialog.FormField,{name:"appUpdateCache",children:(0,D.jsx)(u.Checkbox,{label:e.formatMessage({id:h.ETranslations.settings_app_update_cache})})}),(0,D.jsx)(u.Dialog.FormField,{name:"browserHistory",children:(0,D.jsx)(u.Checkbox,{label:e.formatMessage({id:h.ETranslations.settings_browser_history_bookmarks_pins_risk_dapp_whitelist}),labelProps:{flex:1}})}),(0,D.jsx)(u.Dialog.FormField,{name:"customToken",children:(0,D.jsx)(u.Checkbox,{label:e.formatMessage({id:h.ETranslations.manage_token_custom_token_title})})}),(0,D.jsx)(u.Dialog.FormField,{name:"customRpc",children:(0,D.jsx)(u.Checkbox,{label:e.formatMessage({id:h.ETranslations.custom_rpc_title})})}),(0,D.jsx)(u.Dialog.FormField,{name:"connectSites",children:(0,D.jsx)(u.Checkbox,{label:e.formatMessage({id:h.ETranslations.settings_connected_sites})})}),(0,D.jsx)(u.Dialog.FormField,{name:"signatureRecord",children:(0,D.jsx)(u.Checkbox,{label:e.formatMessage({id:h.ETranslations.settings_signature_record})})})]})})},CleanDataItem=function(){var{copyText:e}=(0,u.useClipboard)(),t=(0,c.A)(),s=(0,N.Q)();return(0,D.jsx)(u.ActionList,{offset:{mainAxis:-4,crossAxis:-10},title:t.formatMessage({id:h.ETranslations.settings_clear_data}),renderTrigger:(0,D.jsx)(_.c,{title:t.formatMessage({id:h.ETranslations.settings_clear_data}),icon:"FolderDeleteOutline",testID:"setting-clear-data",children:(0,D.jsx)(_.c.DrillIn,{name:"ChevronDownSmallOutline"})}),items:[{label:t.formatMessage({id:h.ETranslations.settings_clear_cache_on_app}),onPress:function(){u.Dialog.show({title:t.formatMessage({id:h.ETranslations.settings_clear_cache_on_app}),renderContent:(0,D.jsx)(ClearCacheOnAppContent,{}),tone:"destructive",confirmButtonProps:{disabledOn:function({getForm:e}){var{getValues:t}=e()||{};if(t){var s=t();return!Object.values(s).some((function(e){return Boolean(e)}))}return!0}},onConfirm:function(){var s=(0,o.A)((function*(s){var n=s.getForm()?.getValues();if(n&&(yield d.A.serviceSetting.clearCacheOnApp(n),u.Toast.success({title:t.formatMessage({id:h.ETranslations.global_success})}),n?.browserCache))if(b.Ay.isRuntimeChrome||b.Ay.isRuntimeEdge){var i="chrome://settings/clearBrowserData";b.Ay.isRuntimeEdge&&(i="edge://settings/clearBrowserData"),u.Dialog.show({title:t.formatMessage({id:h.ETranslations.settings_clear_browser_cache}),description:t.formatMessage({id:h.ETranslations.settings_clear_browser_cache_desc},{url:i}),onConfirm:function(){e(i)},showCancelButton:!1,confirmButtonProps:{variant:"primary",size:"large",icon:"Copy1Outline"},onConfirmText:t.formatMessage({id:h.ETranslations.global_copy})})}else u.Dialog.show({title:t.formatMessage({id:h.ETranslations.settings_clear_browser_cache}),description:t.formatMessage({id:h.ETranslations.settings_clear_browser_cache_desc2}),showCancelButton:!1,confirmButtonProps:{variant:"primary",size:"large",icon:"Copy1Outline"}})}));return function onConfirm(e){return s.apply(this,arguments)}}()})}},{label:t.formatMessage({id:h.ETranslations.settings_clear_pending_transactions}),onPress:function(){u.Dialog.show({title:t.formatMessage({id:h.ETranslations.settings_clear_pending_transactions}),description:t.formatMessage({id:h.ETranslations.settings_clear_pending_transactions_desc}),tone:"destructive",onConfirmText:t.formatMessage({id:h.ETranslations.global_clear}),onConfirm:function(){var e=(0,o.A)((function*(){yield d.A.serviceSetting.clearPendingTransaction(),G.iL.emit(G.Tu.ClearLocalHistoryPendingTxs,void 0),u.Toast.success({title:t.formatMessage({id:h.ETranslations.global_success})})}));return function onConfirm(){return e.apply(this,arguments)}}()})}},{label:t.formatMessage({id:h.ETranslations.settings_reset_app}),destructive:!0,onPress:s,testID:"setting-erase-data"}]})},AppAutoLockItem=function(){var[{isPasswordSet:e,appLockDuration:t}]=(0,U.MW)(),s=(0,P.A)(),n=(0,a.useCallback)((function(){s.push(w.Pj.SettingAppAutoLockModal)}),[s]),i=(0,c.A)(),r=(0,J.I)(),o=(0,a.useMemo)((function(){var e,s=r.find((function(e){return e.value===String(t)}));return null!=(e=s?.title)?e:""}),[r,t]);return e?(0,D.jsx)(_.c,{onPress:n,icon:"ClockTimeHistoryOutline",title:i.formatMessage({id:h.ETranslations.settings_auto_lock}),drillIn:!0,children:(0,D.jsx)(_.c.Text,{primary:o,align:"right"})}):null},SetPasswordItem=function(){var e=(0,c.A)();return(0,D.jsx)(_.c,{testID:"setting-set-password",onPress:function(){d.A.servicePassword.promptPasswordVerify()},icon:"KeyOutline",title:e.formatMessage({id:h.ETranslations.global_set_password}),drillIn:!0})},ChangePasswordItem=function(){var e=(0,c.A)(),t=(0,a.useCallback)((0,o.A)((function*(){var t=yield d.A.servicePassword.promptPasswordVerify({reason:W.a.Security}),s=u.Dialog.show({title:e.formatMessage({id:h.ETranslations.global_change_password}),renderContent:(0,D.jsx)(K.A,{oldEncodedPassword:t.password,onUpdateRes:function(){var e=(0,o.A)((function*(e){e&&(yield s.close())}));return function(t){return e.apply(this,arguments)}}()}),showFooter:!1})})),[e]);return(0,D.jsx)(_.c,{onPress:t,icon:"KeyOutline",title:e.formatMessage({id:h.ETranslations.global_change_password}),drillIn:!0})},PasswordItem=function(){var[{isPasswordSet:e}]=(0,U.MW)();return e?(0,D.jsx)(ChangePasswordItem,{}):(0,D.jsx)(SetPasswordItem,{})},FaceIdItem=function(){var e=(0,c.A)(),[{isPasswordSet:t}]=(0,U.MW)(),[{isSupport:s,authType:n}]=(0,U.Bd)(),[{isSupport:i}]=(0,U.GZ)(),r=e.formatMessage({id:h.ETranslations.global_touch_id}),o="TouchIdSolid";return s&&(n.includes(R.h.FACIAL_RECOGNITION)||n.includes(R.h.IRIS))&&(r=e.formatMessage({id:n.length>1?h.ETranslations.global_biometric:h.ETranslations.global_face_id}),o="FaceIdSolid"),t&&(s||i)?(0,D.jsx)(_.c,{icon:o,title:r,children:(0,D.jsx)(V.V,{})}):null},ProtectionItem=function(){var e=(0,c.A)(),[{isPasswordSet:t}]=(0,U.MW)(),s=(0,P.A)(),n=(0,a.useCallback)((function(){s.push(w.Pj.SettingProtectModal)}),[s]);return t?(0,D.jsx)(_.c,{onPress:n,icon:"ShieldCheckDoneOutline",title:e.formatMessage({id:h.ETranslations.settings_protection}),drillIn:!0}):null},ConnectedSitesItem=function(){var e=(0,c.A)(),t=(0,P.A)(),s=(0,a.useCallback)((function(){t.pushModal(w.ry.DAppConnectionModal,{screen:w.EB.ConnectionList})}),[t]);return(0,D.jsx)(_.c,{title:e.formatMessage({id:h.ETranslations.settings_connected_sites}),icon:"LinkOutline",drillIn:!0,onPress:s})},SignatureRecordItem=function(){var e=(0,c.A)(),t=(0,P.A)(),s=(0,a.useCallback)((function(){t.push(w.Pj.SettingSignatureRecordModal)}),[t]);return(0,D.jsx)(_.c,{onPress:s,icon:"NoteOutline",title:e.formatMessage({id:h.ETranslations.settings_signature_record}),drillIn:!0})},SecuritySection=function(){var e=(0,c.A)();return(0,D.jsxs)(Section,{title:e.formatMessage({id:h.ETranslations.global_security}),children:[(0,D.jsx)(a.Suspense,{fallback:null,children:(0,D.jsx)(FaceIdItem,{})}),(0,D.jsx)(AppAutoLockItem,{}),(0,D.jsx)(PasswordItem,{}),b.Ay.isWebDappMode?null:(0,D.jsx)(ConnectedSitesItem,{}),(0,D.jsx)(SignatureRecordItem,{}),(0,D.jsx)(ProtectionItem,{}),(0,D.jsx)(CleanDataItem,{})]})},SocialButton=function({icon:e,url:t,text:s}){var n=(0,a.useCallback)((function(){(0,j.Dr)(t)}),[t]);return(0,D.jsx)(u.Tooltip,{renderTrigger:(0,D.jsx)(u.IconButton,{bg:"$bgSubdued",width:"$14",height:"$14",icon:e,borderRadius:"$full",onPress:n}),renderContent:s,placement:"top"})},SocialButtonGroup=function(){var e,t,s=(0,c.A)(),{copyText:n}=(0,u.useClipboard)(),[i]=(0,f.useAppUpdatePersistAtom)(),r=s.formatMessage({id:h.ETranslations.settings_version_versionnum},{versionNum:`${null!=(e=b.Ay.version)?e:""} ${null!=(t=b.Ay.buildNumber)?t:""}`}),o=(0,a.useCallback)((function(){y((function(){return n(`${r}-${b.Ay.githubSHA||""}`)}))}),[n,r]);return(0,D.jsxs)(u.YStack,{children:[(0,D.jsx)(u.XStack,{justifyContent:"center",children:(0,D.jsxs)(u.XStack,{gap:"$3",paddingVertical:"$3",my:"$3",children:[(0,D.jsx)(SocialButton,{icon:"OnekeyBrand",url:m.eG,text:s.formatMessage({id:h.ETranslations.global_official_website})}),(0,D.jsx)(SocialButton,{icon:"DiscordBrand",url:m.zp,text:s.formatMessage({id:h.ETranslations.global_discord})}),(0,D.jsx)(SocialButton,{icon:"Xbrand",url:m.Gz,text:s.formatMessage({id:h.ETranslations.global_x})}),(0,D.jsx)(SocialButton,{icon:"GithubBrand",url:m.Oe,text:s.formatMessage({id:h.ETranslations.global_github})})]})}),(0,D.jsxs)(u.YStack,{jc:"center",py:"$4",ai:"center",userSelect:"none",testID:"setting-version",children:[(0,D.jsx)(u.SizableText,{color:"$textSubdued",onPress:o,children:r}),i.status===p.ue.done?(0,D.jsx)(u.SizableText,{color:"$textSubdued",children:s.formatMessage({id:h.ETranslations.update_app_up_to_date})}):null]})]})};function SettingListModal(){var e,t=(0,l.lq)(),s=null!=(e=t.params?.flag)?e:"",{setWebAuthEnable:n}=(0,g.Z)(),[{webAuthCredentialId:i}]=(0,f.usePasswordPersistAtom)();(0,a.useEffect)((function(){"webAuthRegistration"!==s||i||(0,o.A)((function*(){(yield n(!0))&&(yield d.A.serviceSetting.setBiologyAuthSwitchOn(!0))}))()}),[s,n,i]);var r=(0,c.A)(),{bottom:p}=(0,u.useSafeAreaInsets)();return(0,D.jsxs)(u.Page,{scrollEnabled:!0,safeAreaEnabled:!1,children:[(0,D.jsx)(u.Page.Header,{title:r.formatMessage({id:h.ETranslations.settings_settings})}),(0,D.jsxs)(u.Page.Body,{children:[(0,D.jsx)(T.B,{}),(0,D.jsx)(PreferenceSection,{}),(0,D.jsx)(SecuritySection,{}),(0,D.jsx)(AdvancedSection,{}),(0,D.jsx)(ResourceSection,{}),(0,D.jsx)(DevSettingsSection,{}),(0,D.jsx)(SocialButtonGroup,{}),p>0?(0,D.jsx)(u.Stack,{height:p||"$2"}):null]})]})}}}]);