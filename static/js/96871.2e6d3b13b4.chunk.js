"use strict";(self.webpackChunkweb=self.webpackChunkweb||[]).push([[96871],{793437:(e,t,n)=>{n.d(t,{X:()=>OpenInAppButton});var r=n(586330),o=n(514041),i=n(908867),a=n(17617),s=n(490343),c=n(889949),l=n(726130),u=n(254491),d=n(663522),f=n(117746),p=n(911998),k=n(831085);function OpenInAppButton({buildDeepLinkUrl:e,buildFullUrl:t}){var n=(0,i.A)(),{result:m}=(0,p.yk)((0,r.A)((function*(){var t=e();return(yield f.Ay.linkingCanOpenURL(t))?t:""})),[e]),y=((0,o.useMemo)((function(){return d.Ay.isWebMobile?d.Ay.isWebMobileAndroid?"Open by OneKey Android":d.Ay.isWebMobileIOS?"Open by OneKey iOS":void 0:"Open by OneKey Desktop"}),[]),(0,o.useCallback)((0,r.A)((function*(){var e=yield t();s.Dialog.show({title:n.formatMessage({id:u.ETranslations.open_in_mobile_app}),floatingPanelProps:{overflow:"hidden"},renderContent:(0,k.jsxs)(s.Stack,{children:[(0,k.jsx)(s.Stack,{alignItems:"center",justifyContent:"center",overflow:"hidden",children:(0,k.jsx)(s.Stack,{p:"$4",borderRadius:"$6",borderCurve:"continuous",borderWidth:a.A.hairlineWidth,borderColor:"$borderSubdued",children:(0,k.jsx)(s.QRCode,{value:e,logo:c,logoSize:40,size:224})})}),(0,k.jsxs)(s.XStack,{m:"$-5",mt:"$5",py:"$4",px:"$5",backgroundColor:"$bgSubdued",alignItems:"center",children:[(0,k.jsx)(s.SizableText,{size:"$bodyMd",color:"$textSubdued",flex:1,children:n.formatMessage({id:u.ETranslations.dont_have_mobile_app_yet})}),(0,k.jsx)(s.Button,{size:"small",onPress:function(){(0,f.Dr)(l.A8)},children:n.formatMessage({id:u.ETranslations.global_download})})]})]}),showFooter:!1})})),[t,n]));return(0,k.jsx)(s.Button,{size:"small",onPress:y,children:n.formatMessage({id:u.ETranslations.open_in_mobile_app})})}},714519:(e,t,n)=>{n.d(t,{t:()=>showNotificationPermissionsDialog});var r=n(586330),o=n(490343),i=n(276360),a=n(610421),s=n(831085),showNotificationPermissionsDialog=function(){return o.Dialog.show({title:"通知权限",renderContent:(0,s.jsxs)(o.Stack,{children:[(0,s.jsx)(o.SizableText,{children:"手动开启权限的步骤引导： 1、2、3"}),(0,s.jsx)(o.SizableText,{children:"更多详情，请查看帮助中心 →"}),(0,s.jsx)(o.Button,{onPress:function(){a.A.serviceNotification.openPermissionSettings()},children:"前往权限设置页 → （部分端可能无法跳转，或跳转错误）"}),(0,s.jsx)(o.Button,{onPress:function(){a.A.serviceNotification.showNotification({title:"test message",description:"This is a test message"})},children:"消息测试"})]}),onConfirmText:"开启权限",onConfirm:(e=(0,r.A)((function*({close:e,preventClose:t}){t(),(yield a.A.serviceNotification.enableNotificationPermissions()).permission===i.cf.granted&&(yield e())})),function onConfirm(t){return e.apply(this,arguments)})});var e}},660823:(e,t,n)=>{n.d(t,{i:()=>TabPageHeader});var r=n(514041),o=n(490343),i=n(901976),a=n(162616),s=n(208257),c=n(325809),l=n(714191),u=n(831085);function HeaderLeft({sceneName:e}){var t=(0,r.useMemo)((function(){return e===l.Zs.homeUrlAccount?(0,u.jsx)(o.Page.Close,{children:(0,u.jsx)(o.NavBackButton,{})}):(0,u.jsx)(c.Qt,{num:0},"accountSelectorTrigger")}),[e]);return(0,u.jsx)(c.b8,{enabledNum:[0],config:{sceneName:e,sceneUrl:""},children:t})}var d=n(324586),f=n(586330),p=n(908867),k=n(896666),m=n(384013),y=n(259227),w=n(254491),h=n(663522),A=n(392097),b=n(251039),g=n(596020),v=n(610421),T=n(498356),I=n(793437),j=n(211129),x=n(491180),S=n(796151),O=n(826339);function OpenInAppButtonContainer(){var{activeAccount:{account:e,network:t}}=(0,a.LH)({num:0}),n=(0,r.useCallback)((function(){return e&&t?S.Ay.buildDeepLinkUrl({path:j.oO.url_account,query:{networkCode:t.code,address:e.address}}):""}),[e,t]),o=(0,r.useCallback)((0,f.A)((function*(){return e&&t?(0,O.Hw)({account:e,network:t}):"n"})),[e,t]);return e?.address&&t?.id?(0,u.jsx)(I.X,{buildDeepLinkUrl:n,buildFullUrl:o}):null}function ShareButton(){var{activeAccount:{account:e,network:t}}=(0,a.LH)({num:0}),{shareText:n}=(0,o.useShare)();return e?.address&&t?.id?(0,u.jsx)(o.HeaderIconButton,{onPress:(0,f.A)((function*(){var r=yield(0,O.Hw)({account:e,network:t});yield n(r)})),icon:"ShareOutline"}):null}var N={Address:function Address(){var{activeAccount:{account:e}}=(0,a.LH)({num:0});return(0,o.useMedia)(),(0,u.jsxs)(o.XStack,{alignItems:"center",children:[(0,u.jsx)(o.SizableText,{size:"$headingLg",children:x.A.shortenAddress({address:e?.address})}),null]})},OpenInApp:function OpenInApp(){return(0,u.jsx)(c.b8,{config:{sceneName:l.Zs.homeUrlAccount,sceneUrl:""},enabledNum:[0],children:(0,u.jsx)(OpenInAppButtonContainer,{})})},Share:function Share(){return(0,u.jsx)(c.b8,{config:{sceneName:l.Zs.homeUrlAccount,sceneUrl:""},enabledNum:[0],children:(0,u.jsx)(ShareButton,{})})}},L=n(834015),C=n(714519),P=n(390574),_=n(506851);function UniversalSearchInput(){var e=(0,p.A)(),t=(0,T.A)(),n=(0,r.useCallback)((function(){t.pushModal(A.ry.UniversalSearchModal,{screen:P.j.UniversalSearch,params:{filterType:_.j.Address}})}),[t]);return(0,u.jsxs)(o.XStack,{w:280,children:[(0,u.jsx)(o.Input,{leftIconName:"SearchOutline",containerProps:{w:"100%"},size:"small",placeholder:e.formatMessage({id:w.ETranslations.global_search_address})},"searchInput"),(0,u.jsx)(o.View,{position:"absolute",top:0,left:0,right:0,bottom:0,onPress:n})]})}function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){(0,d.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function HeaderRight({sceneName:e}){var t=(0,p.A)(),n=(0,T.A)(),i=(0,L.A)(),[{firstTimeGuideOpened:s,badge:c},d]=(0,y.useNotificationsAtom)(),{activeAccount:{account:I}}=(0,a.LH)({num:0}),[j]=(0,m.RI)(),[x]=(0,m.D4)(),S=(0,r.useCallback)((function(){n.pushModal(A.ry.SettingModal,{screen:A.Pj.SettingListModal})}),[n]),O=(0,r.useCallback)((function(){return i.start({handlers:i.PARSE_HANDLER_NAMES.all,autoHandleResult:!0,account:I,tokens:{data:j.tokens,keys:j.keys,map:x}})}),[i,I,j,x]),P=(0,o.useMedia)(),_=(0,r.useCallback)((0,f.A)((function*(){if(!s)return(0,C.t)(),void d((function(e){return _objectSpread(_objectSpread({},e),{},{firstTimeGuideOpened:!0})}));n.pushModal(A.ry.NotificationsModal,{screen:b.f.NotificationList})})),[s,n,d]),M=(0,r.useMemo)((function(){var n,r,i,a=(0,u.jsx)(k.v$,{title:t.formatMessage({id:w.ETranslations.settings_settings}),icon:"SettingsOutline",testID:"setting",onPress:S},"setting"),d={routes:""},p=(0,u.jsx)(o.ActionList,{title:t.formatMessage({id:w.ETranslations.global_layout}),items:[h.Ay.isExtensionUiPopup?{label:t.formatMessage({id:w.ETranslations.open_as_sidebar}),icon:"LayoutRightOutline",onPress:(i=(0,f.A)((function*(){yield g.Ay.openPanelOnActionClick(!0),yield g.Ay.openSidePanel(d),window.close()})),function onPress(){return i.apply(this,arguments)})}:{label:t.formatMessage({id:w.ETranslations.open_as_popup}),icon:"LayoutTopOutline",onPress:(r=(0,f.A)((function*(){yield g.Ay.openPanelOnActionClick(!1),window.close()})),function onPress(){return r.apply(this,arguments)})},{label:t.formatMessage({id:w.ETranslations.global_expand_view}),icon:"ExpandOutline",onPress:(n=(0,f.A)((function*(){window.close(),yield v.A.serviceApp.openExtensionExpandTab(d)})),function onPress(){return n.apply(this,arguments)})}],renderTrigger:(0,u.jsx)(k.v$,{title:t.formatMessage({id:w.ETranslations.global_layout}),icon:"LayoutRightOutline"},"layoutRightView")}),m=(0,u.jsx)(k.v$,{title:t.formatMessage({id:w.ETranslations.scan_scan_qr_code}),icon:"ScanOutline",onPress:O},"scan"),y=(0,u.jsxs)(o.Stack,{children:[(0,u.jsx)(k.v$,{title:t.formatMessage({id:w.ETranslations.global_notifications}),icon:"BellOutline",onPress:_},"notifications"),!s||c?(0,u.jsx)(o.Stack,{borderRadius:"$full",bg:"$bgApp",position:"absolute",right:"$-2.5",top:"$-2",borderWidth:2,borderColor:"$transparent",pointerEvents:"none",children:(0,u.jsx)(o.Stack,{px:"$1",borderRadius:"$full",bg:"$bgCriticalStrong",minWidth:"$4",minHeight:"$4",alignItems:"center",justifyContent:"center",children:s?(0,u.jsx)(o.SizableText,{color:"$textOnColor",size:"$bodySm",children:c}):(0,u.jsx)(o.Stack,{width:"$1",height:"$1",backgroundColor:"white",borderRadius:"$full"})})}):null]}),A=P.gtMd?(0,u.jsx)(UniversalSearchInput,{},"searchInput"):null;return e===l.Zs.homeUrlAccount?[(0,u.jsx)(N.OpenInApp,{},"urlAccountOpenInApp"),(0,u.jsx)(N.Share,{},"urlAccountShare")].filter(Boolean):h.Ay.isExtensionUiPopup||h.Ay.isExtensionUiSidePanel?[p,y,a]:[m,y,a,A]}),[t,S,O,_,c,s,P.gtMd,e]);return(0,u.jsx)(k.bE,{testID:"Wallet-Page-Header-Right",className:"app-region-no-drag",children:M})}function HeaderTitle({sceneName:e}){var t=(0,r.useMemo)((function(){if(e===l.Zs.homeUrlAccount)return(0,u.jsx)(N.Address,{},"urlAccountNavHeaderAddress")}),[e]);return(0,u.jsx)(c.b8,{enabledNum:[0],config:{sceneName:e,sceneUrl:""},children:t})}function TabPageHeader({sceneName:e,showHeaderRight:t}){(0,i.e)({name:`web TabPageHeader:${e}:${String(t)}`});var n=(0,r.useCallback)((function(){return(0,u.jsx)(HeaderLeft,{sceneName:e})}),[e]),{config:l}=(0,a.H9)(),d=(0,r.useCallback)((function(){return t&&l?(0,u.jsx)(s.p,{children:(0,u.jsx)(c.b8,{enabledNum:[0],config:l,children:(0,u.jsx)(HeaderRight,{sceneName:e})})}):null}),[l,e,t]),f=(0,r.useCallback)((function(){return(0,u.jsx)(HeaderTitle,{sceneName:e})}),[e]);return(0,u.jsx)(u.Fragment,{children:(0,u.jsx)(o.Page.Header,{headerTitle:f,headerLeft:n,headerRight:d})})}},989840:(e,t,n)=>{n.d(t,{wu:()=>p,Lu:()=>useAccountOverviewActions,Al:()=>b,mw:()=>h,we:()=>k});var r=n(324586),o=n(230414),i=n(929296),a=n(195309),s=n(972715),c=n(514041),l=n(241440),u=n(657355),d=n(714178),f=n(809690),{Provider:p,withProvider:k,contextAtom:m,contextAtomMethod:y}=(0,f.f)(),{atom:w,use:h}=m({worth:"0",createAtNetworkWorth:"0",accountId:"",initialized:!1}),{atom:A,use:b}=m({isRefreshing:!1,initialized:!1});function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){(0,r.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _createSuper(e){var t=_isNativeReflectConstruct();return function _createSuperInternal(){var n,r=(0,s.A)(e);if(t){var o=(0,s.A)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return(0,a.A)(this,n)}}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}var g=function(e){(0,i.A)(ContextJotaiActionsAccountOverview,e);var t=_createSuper(ContextJotaiActionsAccountOverview);function ContextJotaiActionsAccountOverview(...e){var n;return(n=t.call(this,...e)).updateAccountOverviewState=y((function(e,t,n){t(A(),_objectSpread(_objectSpread({},e(A())),n))})),n.updateAccountWorth=y((function(e,t,n){var r;if(n.merge){var o,i,{worth:a,createAtNetworkWorth:s}=e(w());t(w(),{worth:new l.A(null!=a?a:"0").plus(null!=(o=n.worth)?o:"0").toFixed(),createAtNetworkWorth:new l.A(null!=s?s:"0").plus(null!=(i=n.createAtNetworkWorth)?i:"0").toFixed(),initialized:n.initialized,accountId:n.accountId})}else t(w(),{worth:n.worth,createAtNetworkWorth:null!=(r=n.createAtNetworkWorth)?r:"0",initialized:n.initialized,accountId:n.accountId})})),n}return(0,o.A)(ContextJotaiActionsAccountOverview)}(d.x),v=(0,u.jq)((function(){return new g}));function useAccountOverviewActions(){var e=v(),t=e.updateAccountWorth.use(),n=e.updateAccountOverviewState.use();return(0,c.useRef)({updateAccountWorth:t,updateAccountOverviewState:n})}},349521:(e,t,n)=>{n.d(t,{F:()=>FirmwareUpdateReminderAlert,a:()=>HomeFirmwareUpdateReminder});var r=n(586330),o=n(514041),i=n(908867),a=n(490343),s=n(259227),c=n(254491),l=n(714191),u=n(610421),d=n(325809),f=n(498356),p=n(911998),k=n(162616),m=n(613838),y=n(318822);function BootloaderModeUpdateReminder(){var e=(0,f.A)(),t=(0,m.B)();return(0,o.useEffect)((function(){var fn=function(e){t.showBootloaderMode({connectId:e.connectId,existsFirmware:e.existsFirmware})};return y.iL.on(y.Tu.ShowFirmwareUpdateFromBootloaderMode,fn),function(){y.iL.off(y.Tu.ShowFirmwareUpdateFromBootloaderMode,fn)}}),[t,e]),null}var w=n(153763),h=n(491180),A=n(831085);function HomeFirmwareUpdateDetectCmp(){var{activeAccount:e}=(0,k.LH)({num:0}),t=e.device?.connectId,n=(0,w.E)(),r=(0,o.useMemo)((function(){return h.A.isHwWallet({walletId:e.wallet?.id})}),[e.wallet?.id]);return(0,o.useEffect)((function(){r&&t&&n&&u.A.serviceFirmwareUpdate.detectActiveAccountFirmwareUpdates({connectId:t})}),[r,t,n]),null}var b=(0,o.memo)((function HomeFirmwareUpdateDetectWithProvider(){var[e]=(0,s.useAppIsLockedAtom)();return e?null:(0,A.jsx)(d.b8,{config:{sceneName:l.Zs.home},enabledNum:[0],children:(0,A.jsx)(HomeFirmwareUpdateDetectCmp,{})})}));function FirmwareUpdateReminderAlert({message:e,onPress:t}){var n=(0,i.A)();return(0,A.jsxs)(a.XStack,{px:"$5",py:"$2",borderTopWidth:"$px",borderBottomWidth:"$px",bg:"$bgInfoSubdued",borderColor:"$borderInfoSubdued",alignItems:"center",gap:"$2",flex:1,children:[(0,A.jsx)(a.Icon,{size:"$4",name:"DownloadOutline",color:"$iconInfo"}),(0,A.jsx)(a.SizableText,{flex:1,size:"$bodyMdMedium",color:"$text",numberOfLines:1,children:e}),(0,A.jsx)(a.Button,{size:"small",onPress:t,children:n.formatMessage({id:c.ETranslations.global_view})})]})}function HomeFirmwareUpdateReminderCmp(){var e=(0,i.A)(),{activeAccount:t}=(0,k.LH)({num:0}),n=t.device?.connectId,l=(0,m.B)(),[d]=(0,s.useFirmwareUpdatesDetectStatusAtom)(),{result:y}=((0,f.A)(),(0,p.yk)((0,r.A)((function*(){if(n){var e=d?.[n],t=e?.connectId===n&&e?.hasUpgrade;yield u.A.serviceFirmwareUpdate.getFirmwareUpdateDetectInfo({connectId:n});return{shouldUpdate:t,detectResult:e}}})),[n,d])),w=(0,o.useMemo)((function(){if(y?.shouldUpdate){var t="New firmware is available";return y?.detectResult?.toVersion?t=e.formatMessage({id:c.ETranslations.update_firmware_version_available},{version:y?.detectResult?.toVersion}):y?.detectResult?.toVersionBle&&(t=e.formatMessage({id:c.ETranslations.update_bluetooth_version_available},{version:y?.detectResult?.toVersionBle})),(0,A.jsx)(FirmwareUpdateReminderAlert,{message:t,onPress:(0,r.A)((function*(){l.openChangeLogModal({connectId:n})}))})}return null}),[e,l,n,y]);return(0,A.jsxs)(a.XStack,{children:[(0,A.jsx)(b,{}),(0,A.jsx)(BootloaderModeUpdateReminder,{}),w]})}function HomeFirmwareUpdateReminder(){return(0,A.jsx)(d.b8,{config:{sceneName:l.Zs.home},enabledNum:[0],children:(0,A.jsx)(HomeFirmwareUpdateReminderCmp,{})})}},323104:(e,t,n)=>{n.d(t,{A:()=>useHomePageWidth});var r=n(514041),o=n(812715),i=n(490343),a=n(40651),s=n(989375);function useHomePageWidth(){var e=(0,i.useMedia)(),t=(0,o.A)().width,n=(0,r.useMemo)((function(){return(0,s.RQ)().size.sideBarWidth.val}),[]),{leftSidebarCollapsed:c}=(0,a.A)();return{screenWidth:t,pageWidth:e.md||c?t:t-n}}},96871:(e,t,n)=>{n.d(t,{U:()=>HomePageView});var r=n(586330),o=n(514041),i=n(908867),a=n(546591),s=n(462723),c=n(490343),l=n(928557),u=n(318822),d=n(254491),f=(n(663522),n(491180)),p=n(714191),k=n(610421),m=n(357829),y=n(660823),w=n(713132),h=(n(117746),n(536612),n(831085));w.ue.notify,w.ue.downloading,w.ue.verifying,w.ue.ready,w.ue.failed,w.ue.done;var UpdateReminder=function(){return null},A=n(911998),b=n(162616),g=n(349521),v=n(324586),T=n(839850),I=n(325809),j=n(575995),x=n(84269),S=["createAddressDisabled"];function HomeSelector_ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function HomeSelector_objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?HomeSelector_ownKeys(Object(n),!0).forEach((function(t){(0,v.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):HomeSelector_ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const O=(0,o.memo)((function HomeSelector(e){(0,c.useMedia)();var{createAddressDisabled:t}=e,n=(0,T.A)(e,S);return(0,h.jsxs)(c.XStack,HomeSelector_objectSpread(HomeSelector_objectSpread({testID:"Wallet-Address-Generator",alignItems:"center",gap:"$3"},n),{},{children:[(0,h.jsx)(x.vO,{num:0}),t?null:(0,h.jsx)(I.Ln,{num:0}),t?null:(0,h.jsx)(j.Xs,{num:0})]}))}));function HomeSupportedWallet({supportedDeviceTypes:e,watchingAccountEnabled:t}){var n=(0,i.A)(),r=[];e&&r.push(...e),t&&r.push("watching");var o={classic:"Classic",classic1s:"Classic 1S",mini:"Mini",touch:"Touch",pro:"Pro",unknown:"",watching:n.formatMessage({id:d.ETranslations.faq_watched_account})},a=(r||[]).map((function(e){return o[e]})).filter((function(e){return e}));return(0,h.jsxs)(c.YStack,{height:"100%",children:[(0,h.jsx)(O,{createAddressDisabled:!0,padding:"$5"}),(0,h.jsx)(c.Stack,{flex:1,justifyContent:"center",children:(0,h.jsx)(c.Empty,{icon:"GlobusOutline",title:n.formatMessage({id:d.ETranslations.selected_network_only_supports_device},{deviceType:a.join(", ")})})})]})}var N=n(323104),L=n(208257),C=n(186207),P=n(292600),_=n(498356),M=n(384013),R=n(392097),E=n(359395),H=n(398509),D=n(69531),$=n(181447);function WalletActionBuy(){var e,t,{activeAccount:{network:n,account:r,wallet:i}}=(0,b.LH)({num:0}),{isSupported:a,handleFiatCrypto:s}=(0,D.TH)({networkId:null!=(e=n?.id)?e:"",accountId:null!=(t=r?.id)?t:"",fiatCryptoType:"buy"}),c=(0,o.useMemo)((function(){return i?.type===$.Hk||!a}),[a,i?.type]);return(0,h.jsx)(H.c.Buy,{onPress:s,disabled:c})}var F=n(404727),B=n(962771),W=n(639563),U=n(15409),V=n(259227);function WalletActionMore(){var e,t,n,a,s,l,[u]=(0,V.useDevSettingsPersistAtom)(),{activeAccount:f}=(0,b.LH)({num:0}),{account:p,network:m,wallet:y,deriveInfo:w,deriveType:g}=f,v=(0,i.A)(),{copyText:T}=(0,c.useClipboard)(),{handleOnReceive:I}=(0,B.m)({accountId:null!=(e=p?.id)?e:"",networkId:null!=(t=m?.id)?t:"",walletId:null!=(n=y?.id)?n:"",deriveInfo:w,deriveType:g}),{isEnable:j,handleWalletAddress:x}=(0,U.p)({activeAccount:f}),{isSupported:S,handleFiatCrypto:O}=(0,D.TH)({accountId:null!=(a=p?.id)?a:"",networkId:null!=(s=m?.id)?s:"",fiatCryptoType:"sell"}),N=(0,o.useMemo)((function(){return y?.type===$.Hk||!S}),[S,y?.type]),L=(0,o.useCallback)((function(){j?x():y?.type===$.FN?I():T(p?.address||"")}),[p?.address,T,I,y?.type,j,x]),C=(0,P.T)(),_=(0,A.yk)((0,r.A)((function*(){var e;return yield k.A.serviceNetwork.getVaultSettings({networkId:null!=(e=m?.id)?e:""})})),[m?.id]).result,M=[];if(_?.copyAddressDisabled&&_?.hideBlockExplorer||M.unshift({items:[..._?.hideBlockExplorer?[]:[{label:v.formatMessage({id:d.ETranslations.global_view_in_blockchain_explorer}),icon:"GlobusOutline",onPress:function(){return(0,W.HM)({networkId:m?.id,address:p?.address})}}],..._?.copyAddressDisabled?[]:[{label:v.formatMessage({id:d.ETranslations.global_copy_address}),icon:"Copy3Outline",onPress:L}]]}),C&&M.unshift({items:[{label:v.formatMessage({id:d.ETranslations.global_sell}),icon:"MinusLargeOutline",disabled:Boolean(N||!p?.id||!m?.id),onPress:O}]}),u?.settings?.showDevExportPrivateKey){var R=(l=(0,r.A)((function*({keyType:e}){var t="";t=e===F.ECoreApiExportedSecretKeyType.xpub||e===F.ECoreApiExportedSecretKeyType.publicKey?yield k.A.serviceAccount.exportAccountPublicKey({accountId:p?.id||"",networkId:m?.id||"",keyType:e}):yield k.A.serviceAccount.exportAccountSecretKey({accountId:p?.id||"",networkId:m?.id||"",keyType:e}),c.Dialog.show({title:"Key",description:t,onConfirmText:"Copy",onConfirm(){T(t||"")}})})),function exportAccountCredentialKey(e){return l.apply(this,arguments)});M.unshift({items:[{label:"Export Public Key",icon:"MinusLargeOutline",onPress:function(){R({keyType:F.ECoreApiExportedSecretKeyType.publicKey})}},{label:"Export xpub",icon:"MinusLargeOutline",onPress:function(){R({keyType:F.ECoreApiExportedSecretKeyType.xpub})}},{label:"Export Private Key",icon:"MinusLargeOutline",onPress:function(){R({keyType:F.ECoreApiExportedSecretKeyType.privateKey})}},{label:"Export xprvt",icon:"MinusLargeOutline",onPress:function(){R({keyType:F.ECoreApiExportedSecretKeyType.xprvt})}}]})}return(0,h.jsx)(H.c.More,{sections:M})}function WalletActionReceive(){var e,t,n,{activeAccount:{network:r,account:i,wallet:a,deriveInfo:s,deriveType:c}}=(0,b.LH)({num:0}),[l]=(0,M.RI)(),[u]=(0,M.D4)(),[d]=(0,M.V3)(),f=(0,o.useMemo)((function(){return a?.type===$.Hk}),[a?.type]),{handleOnReceive:p}=(0,B.m)({accountId:null!=(e=i?.id)?e:"",networkId:null!=(t=r?.id)?t:"",walletId:null!=(n=a?.id)?n:"",deriveInfo:s,deriveType:c,tokens:{data:l.tokens,keys:l.keys,map:u},tokenListState:d});return(0,h.jsx)(H.c.Receive,{disabled:f,onPress:function(){return p()}})}function WalletActions_ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function WalletActions_objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?WalletActions_ownKeys(Object(n),!0).forEach((function(t){(0,v.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):WalletActions_ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function WalletActionSend(){var e=(0,_.A)(),{activeAccount:{account:t,network:n,wallet:a}}=(0,b.LH)({num:0}),s=(0,i.A)(),[c]=(0,M.RI)(),[l]=(0,M.D4)(),[u]=(0,M.V3)(),p=(0,A.yk)((0,r.A)((function*(){var e;return yield k.A.serviceNetwork.getVaultSettings({networkId:null!=(e=n?.id)?e:""})})),[n?.id]).result,m=(0,o.useCallback)((0,r.A)((function*(){if(t&&n)if(p?.isSingleToken){var o=yield k.A.serviceToken.getNativeToken({networkId:n.id,accountId:t.id});e.pushModal(R.ry.SendModal,{screen:R.j$.SendDataInput,params:{accountId:t.id,networkId:n.id,isNFT:!1,token:o}})}else{var i;e.pushModal(R.ry.SendModal,{screen:R.j$.SendSelectToken,params:{title:s.formatMessage({id:d.ETranslations.global_send}),searchPlaceholder:s.formatMessage({id:d.ETranslations.global_search_asset}),networkId:n.id,accountId:t.id,tokens:{data:c.tokens,keys:c.keys,map:l},tokenListState:u,closeAfterSelect:!1,onSelect:(i=(0,r.A)((function*(r){var o,i,s,c;if((yield k.A.serviceNetwork.getVaultSettings({networkId:null!=(o=r.networkId)?o:""})).mergeDeriveAssetsEnabled&&n.isAllNetworks&&!f.A.isOthersWallet({walletId:null!=(i=a?.id)?i:""})){var u,d,p,m,y=f.A.getWalletIdFromAccountId({accountId:null!=(u=r.accountId)?u:""});e.push(R.j$.SendSelectDeriveAddress,{networkId:null!=(d=r.networkId)?d:"",indexedAccountId:null!=(p=t.indexedAccountId)?p:"",walletId:y,accountId:null!=(m=r.accountId)?m:"",actionType:E.rI.Select,token:r,tokenMap:l,onUnmounted:function(){},onSelected:function({account:t}){var o;e.push(R.j$.SendDataInput,{accountId:t.id,networkId:null!=(o=r.networkId)?o:n.id,isNFT:!1,token:r,isAllNetworks:n?.isAllNetworks})}})}else e.push(R.j$.SendDataInput,{accountId:null!=(s=r.accountId)?s:t.id,networkId:null!=(c=r.networkId)?c:n.id,isNFT:!1,token:r,isAllNetworks:n?.isAllNetworks})})),function onSelect(e){return i.apply(this,arguments)})}})}})),[t,n,p?.isSingleToken,e,s,c.tokens,c.keys,l,u,a?.id]);return(0,h.jsx)(H.c.Send,{onPress:m,disabled:p?.disabledSendAction})}function WalletActionSwap({networkId:e}){var t=(0,_.A)(),n=(0,A.yk)((0,r.A)((function*(){return yield k.A.serviceNetwork.getVaultSettings({networkId:null!=e?e:""})})),[e]).result,i=(0,o.useCallback)((function(){t.pushModal(R.ry.SwapModal,{screen:R.uw.SwapMainLand,params:{importNetworkId:e}})}),[t,e]);return(0,h.jsx)(H.c.Swap,{onPress:i,disabled:n?.disabledSwapAction})}function WalletActions(e){var t=Object.assign({},((0,C.A)(e),e)),{activeAccount:{network:n}}=(0,b.LH)({num:0});return(0,h.jsxs)(H.c,WalletActions_objectSpread(WalletActions_objectSpread({},t),{},{children:[(0,h.jsx)(P.O,{children:(0,h.jsx)(WalletActionBuy,{})}),(0,h.jsx)(WalletActionSwap,{networkId:n?.id}),(0,h.jsx)(WalletActionSend,{}),(0,h.jsx)(WalletActionReceive,{}),(0,h.jsx)(WalletActionMore,{})]}))}var z=n(403144),K=n(827037),q=n(686233),G=n(989840),X=n(432178);function HomeOverviewContainer_ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function HomeOverviewContainer_objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?HomeOverviewContainer_ownKeys(Object(n),!0).forEach((function(t){(0,v.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):HomeOverviewContainer_ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function HomeOverviewContainer(){var e,t,{activeAccount:{account:n,network:a,wallet:s}}=(0,b.LH)({num:0}),l=(0,i.A)(),[m,y]=(0,o.useState)(!1),[w,g]=(0,o.useState)(!1),[v,T]=(0,o.useState)(!1),[I,j]=(0,o.useState)(!1),x=(0,o.useRef)(""),[S]=(0,G.mw)(),[O]=(0,G.Al)(),{updateAccountOverviewState:N,updateAccountWorth:L}=(0,G.Lu)().current,[C]=(0,V.useSettingsPersistAtom)(),{result:P}=(0,A.yk)((0,r.A)((function*(){if(a)return k.A.serviceNetwork.getVaultSettings({networkId:a.id})})),[a]);(0,o.useEffect)((function(){n?.id&&a?.id&&s?.id&&(N({initialized:!1,isRefreshing:!0}),a.isAllNetworks&&L({accountId:n.id,worth:"0",initialized:!1}))}),[n?.id,a?.id,a?.isAllNetworks,N,L,s?.id]),(0,o.useEffect)((function(){var fn=function({isRefreshing:e,type:t,accountId:n,networkId:r}){var o=`${n}-${r}`;!e&&x.current&&x.current!==o||(x.current=o,t===p.GV.TOKENS?g(e):t===p.GV.NFT?T(e):t===p.GV.HISTORY&&j(e),y(e))};return u.iL.on(u.Tu.TabListStateUpdate,fn),function(){u.iL.off(u.Tu.TabListStateUpdate,fn)}}),[]),(0,o.useEffect)((function(){if(n&&a&&S.initialized&&n.id===S.accountId)if(f.A.isOthersAccount({accountId:n.id})){if(!a.isAllNetworks&&n.createAtNetwork!==a.id)return;var e=n.id;k.A.serviceAccountProfile.updateAccountValue({accountId:e,value:S.createAtNetworkWorth,currency:C.currencyInfo.id})}else if(!f.A.isOthersAccount({accountId:n.id})&&a.isAllNetworks){var t=n.indexedAccountId;k.A.serviceAccountProfile.updateAccountValue({accountId:t,value:S.worth,currency:C.currencyInfo.id})}}),[n,S.accountId,S.createAtNetworkWorth,S.initialized,S.worth,a,C.currencyInfo.id,s]);var{md:_}=(0,c.useMedia)(),M=(0,o.useRef)(null),R=(0,o.useRef)(null),E=(0,o.useCallback)((function(){m||(y(!0),u.iL.emit(u.Tu.AccountDataUpdate,void 0))}),[m]),H=m||w||v||I,D=(0,o.useMemo)((function(){return(0,h.jsx)(c.IconButton,{icon:"RefreshCcwOutline",variant:"tertiary",loading:H,onPress:E})}),[E,H]),$=(0,o.useCallback)((0,r.A)((function*(){var e=yield V.settingsValuePersistAtom.get();yield V.settingsValuePersistAtom.set({hideValue:!e.hideValue})})),[]),F=(0,o.useCallback)((function(){var e,t;M?.current||(M.current=(0,X.k)({accountId:null!=(e=n?.id)?e:"",networkId:null!=(t=a?.id)?t:"",onClose:function(){M.current=null}}))}),[n,a]),B=(0,o.useCallback)((function(){var e,t;R?.current||(R.current=(0,q.u)({accountId:null!=(e=n?.id)?e:"",networkId:null!=(t=a?.id)?t:"",onClose:function(){R.current=null}}))}),[n?.id,a?.id]);if(O.isRefreshing&&!O.initialized)return(0,h.jsx)(c.Stack,{py:"$2.5",children:(0,h.jsx)(c.Skeleton,{w:"$40",h:"$7",my:"$2.5"})});var W=null!=(e=S.worth)?e:"0",U="$heading5xl",J={formatter:"value",formatterOptions:{currency:C.currencyInfo.symbol}};return(0,h.jsxs)(c.YStack,{gap:"$2.5",alignItems:"flex-start",children:[(0,h.jsxs)(c.XStack,{alignItems:"center",gap:"$3",children:[(0,h.jsx)(c.XStack,{flexShrink:1,borderRadius:"$3",px:"$1",py:"$0.5",mx:"$-1",my:"$-0.5",cursor:"default",focusable:!0,hoverStyle:{bg:"$bgHover"},pressStyle:{bg:"$bgActive"},focusVisibleStyle:{outlineColor:"$focusRing",outlineWidth:2,outlineOffset:0,outlineStyle:"solid"},onPress:$,children:(0,h.jsx)(K.A,HomeOverviewContainer_objectSpread(HomeOverviewContainer_objectSpread({hideValue:!0,flexShrink:1,minWidth:0},J),{},{size:_&&null!=(t=[{length:17,size:"$headingXl"},{length:13,size:"$heading4xl"}].find((function(e){return(0,z.jq)(String(W),J,!0).length>=e.length}))?.size)?t:U,children:W}))}),D]}),P?.hasFrozenBalance?(0,h.jsx)(c.Button,{onPress:F,variant:"tertiary",size:"small",iconAfter:"InfoCircleOutline",children:l.formatMessage({id:d.ETranslations.balance_detail_button_balance})}):void 0,P?.hasResource?(0,h.jsx)(c.Button,{onPress:B,variant:"tertiary",size:"small",iconAfter:"InfoCircleOutline",children:l.formatMessage({id:P.resourceKey})}):void 0]})}function HomeHeaderContainer(){return(0,h.jsx)(L.p,{children:(0,h.jsxs)(c.Stack,{testID:"Wallet-Tab-Header",p:"$5",bg:"$bgApp",children:[(0,h.jsx)(O,{mb:"$2.5"}),(0,h.jsxs)(c.Stack,{$gtLg:{flexDirection:"row",justifyContent:"space-between",alignItems:"center"},children:[(0,h.jsx)(HomeOverviewContainer,{}),(0,h.jsx)(WalletActions,{pt:"$5",$gtLg:{pt:0}})]})]})})}var J=n(787835),Z=n.n(J),Y=n(625931),Q=n(227428),ee=n(603514),te=n.n(ee),ne=n(482407),re={current:""};function useAllNetworkRequests(e){var{account:t,network:n,wallet:i,allNetworkRequests:a,abortAllNetworkRequests:s,clearAllNetworkData:c,isNFTRequests:l,disabled:u,interval:d=0,shouldAlwaysFetch:f,onStarted:p,onFinished:m}=e,y=(0,o.useRef)(!1),w=(0,o.useRef)(!1),[h,b]=(0,o.useState)(!1),{run:g,result:v}=(0,A.yk)((0,r.A)((function*(){var e=(0,ne.lk)();if(!u&&!w.current&&t&&n&&i&&n.isAllNetworks){w.current=!0,y.current||c(),s?.();var{accountsInfo:r,accountsInfoBackendIndexed:o,accountsInfoBackendNotIndexed:d}=yield k.A.serviceAllNetwork.getAllNetworkAccounts({accountId:t.id,networkId:n.id,deriveType:void 0,nftEnabledOnly:l});if(!r||te()(r))return b(!0),void(w.current=!1);var f=null;if(0===r.length)return b(!0),void(w.current=!1);if(b(!1),p?.({accountId:t.id,networkId:n.id,allNetworkDataInit:y.current}),re.current=e,y.current){var h=r.map((function(e){var{accountId:t,networkId:n}=e;return a({accountId:t,networkId:n,allNetworkDataInit:y.current})}));try{f=(yield Promise.all(h)).filter(Boolean)}catch(e){f=null,s?.()}}else{try{yield Promise.all(Array.from(o).map((function(e){var{accountId:t,networkId:n,apiAddress:r}=e;return a({accountId:t,networkId:n,allNetworkDataInit:y.current})})))}catch(e){}try{yield Promise.all(Array.from(d).map((function(e){var{accountId:t,networkId:n,apiAddress:r}=e;return a({accountId:t,networkId:n,allNetworkDataInit:y.current})})))}catch(e){}}return y.current=!0,w.current=!1,m?.({accountId:t.id,networkId:n.id}),f}})),[u,t,n,i,s,l,p,m,c,a],{debounced:Q.EI,overrideIsFocused:function(e){return e||!!f}});return(0,o.useEffect)((function(){t?.id&&n?.id&&i?.id&&(y.current=!1)}),[t?.id,n?.id,i?.id]),{run:g,result:v,isEmptyAccount:h,allNetworkDataInit:y}}var oe=n(230414),ie=n(929296),ae=n(195309),se=n(972715),ce=n(657355),le=n(714178),ue=n(809690),{Provider:de,withProvider:fe,contextAtom:pe,contextAtomMethod:ke}=(0,ue.f)(),{atom:me,use:ye}=pe("");function _createSuper(e){var t=_isNativeReflectConstruct();return function _createSuperInternal(){var n,r=(0,se.A)(e);if(t){var o=(0,se.A)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return(0,ae.A)(this,n)}}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}var we=function(e){(0,ie.A)(ContextJotaiActionsNFTList,e);var t=_createSuper(ContextJotaiActionsNFTList);function ContextJotaiActionsNFTList(...e){var n;return(n=t.call(this,...e)).updateSearchKey=ke((function(e,t,n){t(me(),n)})),n}return(0,oe.A)(ContextJotaiActionsNFTList)}(le.x),he=(0,ce.jq)((function(){return new we}));function useNFTListActions(){var e=he().updateSearchKey.use();return(0,o.useRef)({updateSearchKey:e})}var Ae=n(535864),be=n(69983),ge=n(669617),ve=n(712784),Te=n.n(ve),Ie=n(327550);function NFTListHeader(e){var{filteredNfts:t}=e,n=(0,i.A)(),[r]=ye(),{updateSearchKey:o}=useNFTListActions().current;return(0,h.jsx)(Ie.W,{px:"$2.5",searchProps:{placeholder:n.formatMessage({id:d.ETranslations.global_search_asset}),onChangeText:Te()((function(e){return o(e)}),Q.FV),searchResultCount:r&&r.length>=Q.NZ?t.length:0}})}var je=n(241440),xe=n(391944),Se=n(298254),Oe=n(982447);var Ne=(0,o.memo)((function BasicNFTListItem(e){var t,{nft:n,onPress:r,flexBasis:i,isAllNetworks:a}=e,[s,l]=(0,o.useState)(!!n.metadata?.image),{network:u}=(0,Se.b)({networkId:n.networkId});return(0,h.jsxs)(c.Stack,{group:"nftItem",flexBasis:i,focusable:!0,focusVisibleStyle:{outlineColor:"$focusRing",outlineWidth:2,outlineStyle:"solid",outlineOffset:-2},p:"$2.5",borderRadius:"$4",onPress:function(){r?.(n)},userSelect:"none",children:[(0,h.jsx)(c.Stack,{pb:"100%","$group-nftItem-hover":{opacity:.8},children:(0,h.jsxs)(c.Stack,{position:"absolute",left:0,top:0,right:0,bottom:0,children:[(0,h.jsxs)(c.Image,{w:"100%",h:"100%",borderRadius:"$2.5",children:[s?(0,h.jsx)(c.Video,{source:{uri:n.metadata?.image},onError:function(){return l(!1)},style:{width:"100%",height:"100%",position:"absolute",zIndex:1},autoPlay:!1}):(0,h.jsx)(c.Image.Source,{src:n.metadata?.image}),(0,h.jsx)(c.Image.Fallback,{bg:"$bgStrong",justifyContent:"center",alignItems:"center",children:(0,h.jsx)(c.Icon,{name:"ImageSquareWavesOutline",color:"$iconDisabled"})})]}),n.collectionType===Oe.m.ERC1155&&new je.A(null!=(t=n.amount)?t:1).gt(1)?(0,h.jsx)(c.Stack,{borderRadius:"$2.5",position:"absolute",right:"$0",bottom:"$0",px:"$2",bg:"$bgInverse",borderWidth:2,borderColor:"$bgApp",children:(0,h.jsxs)(c.SizableText,{size:"$bodyMdMedium",color:"$textInverse",children:["x",new je.A(n.amount).gt(Q.JA)?`${Q.JA}+`:n.amount]})}):null]})}),(0,h.jsxs)(c.Stack,{mt:"$2",children:[(0,h.jsxs)(c.XStack,{alignItems:"center",justifyContent:"space-between",children:[(0,h.jsx)(c.SizableText,{size:"$bodySm",color:"$textSubdued",minWidth:0,flex:1,numberOfLines:1,pr:"$2",children:n.collectionName||"-"}),a?(0,h.jsx)(xe.o,{width:"$3.5",height:"$3.5",tokenImageUri:u?.logoURI}):null]}),(0,h.jsx)(c.SizableText,{size:"$bodyLgMedium",numberOfLines:1,children:n.metadata?.name||"-"})]})]},n.itemId)}));function NFTListView_ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function NFTListView_objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?NFTListView_ownKeys(Object(n),!0).forEach((function(t){(0,v.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):NFTListView_ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var useMumColumns=function(){var{gtSm:e,gtLg:t,gtXl:n,gt2xl:r}=(0,c.useMedia)();return(0,o.useMemo)((function(){return r?{flexBasis:"14.2857142857%",numColumns:7}:n?{flexBasis:"16.666666%",numColumns:6}:t?{flexBasis:"25%",numColumns:4}:e?{flexBasis:"33.333333%",numColumns:3}:{flexBasis:"50%",numColumns:2}}),[r,t,e,n])};function NFTListView(e){var{data:t,isLoading:n,initialized:r,inTabList:i=!1,isAllNetworks:a}=e,[s]=ye(),l=(0,ge.D_)({nfts:t,searchKey:s}),u=(0,_.A)(),{activeAccount:{account:d,network:f,wallet:p}}=(0,b.LH)({num:0}),k=(0,o.useCallback)((function(e){var t,n;d&&f&&p&&u.pushModal(R.ry.MainModal,{screen:R.kZ.NFTDetails,params:{networkId:null!=(t=e.networkId)?t:f.id,accountId:null!=(n=e.accountId)?n:d.id,walletId:p.id,collectionAddress:e.collectionAddress,itemId:e.itemId}})}),[d,u,f,p]),{flexBasis:y,numColumns:w}=useMumColumns(),A=(0,o.useCallback)((function({item:e}){return(0,h.jsx)(Ne,{nft:e,flexBasis:y,onPress:k,isAllNetworks:a},`${e.collectionAddress}-${e.itemId}`)}),[y,k,a]),{listViewProps:g,listViewRef:v,onLayout:T}=(0,be.q)({inTabList:i}),I=(0,o.useMemo)((function(){return{pb:"$6",px:"$2.5"}}),[]);return!r&&n?(0,h.jsx)(Ae.yu,{}):(0,o.createElement)(c.ListView,NFTListView_objectSpread(NFTListView_objectSpread({},g),{},{ref:v,renderScrollComponent:c.renderNestedScrollView,key:w,onLayout:T,contentContainerStyle:I,numColumns:w,data:l,renderItem:A,ListHeaderComponent:(0,h.jsx)(NFTListHeader,{filteredNfts:l}),ListEmptyComponent:s?(0,h.jsx)(m.wE,{}):(0,h.jsx)(m.eZ,{})}))}var Le=(0,Y.V)();var Ce=(0,o.memo)(fe((function NFTListContainer(e){var t,{isFocused:n,isHeaderRefreshing:i,setIsHeaderRefreshing:a}=(0,c.useTabIsRefreshingFocused)(),{updateSearchKey:s}=useNFTListActions().current,[l,d]=(0,o.useState)({initialized:!1,isRefreshing:!1}),[f,m]=(0,o.useState)([]),{activeAccount:{account:y,network:w,wallet:g}}=(0,b.LH)({num:0}),{run:v}=(0,A.yk)((0,r.A)((function*(){if(y&&w&&!w.isAllNetworks){u.iL.emit(u.Tu.TabListStateUpdate,{isRefreshing:!0,type:p.GV.NFT,accountId:y.id,networkId:w.id}),yield k.A.serviceNFT.abortFetchAccountNFTs();var e=yield k.A.serviceNFT.fetchAccountNFTs({accountId:y.id,networkId:w.id});return d({initialized:!0,isRefreshing:!1}),a(!1),m(e.data),u.iL.emit(u.Tu.TabListStateUpdate,{isRefreshing:!1,type:p.GV.NFT,accountId:y.id,networkId:w.id}),e.data}})),[y,w,a],{overrideIsFocused:function(e){return e&&n},debounced:Q.EI,pollingInterval:Q.Pi}),T=(0,o.useRef)(!1),I=(0,o.useCallback)((t=(0,r.A)((function*({accountId:e,networkId:t,allNetworkDataInit:n}){var r=yield k.A.serviceNFT.fetchAccountNFTs({accountId:e,networkId:t,isAllNetworks:!0,isManualRefresh:T.current,allNetworksAccountId:y?.id,allNetworksNetworkId:w?.id});return!n&&r.networkId===Le.onekeyall&&r.isSameAllNetworksAccountData&&(m((function(e){return Z()([...e,...r.data],(function(e){return`${e.collectionAddress}_${e.itemId}`}))})),d({initialized:!0,isRefreshing:!1})),T.current=!1,r})),function(e){return t.apply(this,arguments)}),[y?.id,w?.id]),j=(0,o.useCallback)((function({accountId:e,networkId:t}){u.iL.emit(u.Tu.TabListStateUpdate,{isRefreshing:!1,type:p.GV.NFT,accountId:null!=e?e:"",networkId:null!=t?t:""})}),[]),x=(0,o.useCallback)((function({accountId:e,networkId:t}){u.iL.emit(u.Tu.TabListStateUpdate,{isRefreshing:!0,type:p.GV.NFT,accountId:null!=e?e:"",networkId:null!=t?t:""})}),[]),S=(0,o.useCallback)((function(){return m([])}),[]),{run:O,result:N,isEmptyAccount:L}=useAllNetworkRequests({account:y,network:w,wallet:g,allNetworkRequests:I,clearAllNetworkData:S,isNFTRequests:!0,onStarted:x,onFinished:j}),C=(0,o.useCallback)((function(){T.current=!0,O()}),[O]);return(0,o.useEffect)((function(){if(N){var e=[];for(var t of N)e=e.concat(t.data);m(Z()(e,(function(e){return`${e.collectionAddress}_${e.itemId}`})))}}),[N]),(0,o.useEffect)((function(){y?.id&&w?.id&&g?.id&&(d({initialized:!1,isRefreshing:!0}),s(""),k.A.serviceNFT.updateCurrentAccount({networkId:w.id,accountId:y.id}))}),[y?.id,w?.id,s,g?.id]),(0,o.useEffect)((function(){i&&v()}),[i,v]),(0,o.useEffect)((function(){L&&(m([]),d({initialized:!0,isRefreshing:!1}))}),[L]),(0,o.useEffect)((function(){var fn=function(){n&&(w?.isAllNetworks?C():v())};return u.iL.on(u.Tu.AccountDataUpdate,fn),function(){u.iL.off(u.Tu.AccountDataUpdate,fn)}}),[C,n,w?.isAllNetworks,v]),(0,h.jsx)(NFTListView,{inTabList:!0,data:null!=f?f:[],isLoading:l.isRefreshing,initialized:l.initialized,isAllNetworks:w?.isAllNetworks})}))),Pe=n(21756);const{Axios:_e,AxiosError:Me,CanceledError:Re,isCancel:Ee,CancelToken:He,VERSION:De,all:$e,Cancel:Fe,isAxiosError:Be,spread:We,toFormData:Ue,AxiosHeaders:Ve,HttpStatusCode:ze,formToJSON:Ke,getAdapter:qe,mergeConfig:Ge}=Pe.A;var Xe=n(578104),Je=n(734818),Ze=n(106049);var Ye=n(641106),Qe=n(727476);function UrlAccountHomeTokenListProviderMirror_ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function UrlAccountHomeTokenListProviderMirror_objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?UrlAccountHomeTokenListProviderMirror_ownKeys(Object(n),!0).forEach((function(t){(0,v.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):UrlAccountHomeTokenListProviderMirror_ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var et=(0,o.memo)((function(e){var t=(0,Qe.y)();return(0,h.jsx)(Ye.m,UrlAccountHomeTokenListProviderMirror_objectSpread(UrlAccountHomeTokenListProviderMirror_objectSpread({},e),{},{data:t}))}));function TokenListContainer_ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function TokenListContainer_objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?TokenListContainer_ownKeys(Object(n),!0).forEach((function(t){(0,v.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):TokenListContainer_ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}et.displayName="UrlAccountHomeTokenListProviderMirror";var tt=(0,Y.V)();function TokenListContainer({showWalletActions:e=!1}){var t,n,i,a,s,l,d,m,y,{isFocused:w,isHeaderRefreshing:g,setIsHeaderRefreshing:v}=(0,c.useTabIsRefreshingFocused)(),{activeAccount:{account:T,network:I,wallet:j,indexedAccount:x,isOthersWallet:S,deriveInfo:O,deriveType:N}}=(0,b.LH)({num:0}),[L,C]=(0,o.useState)(!1),P=(0,o.useRef)({keys:"",tokens:[],map:{}}),E=(0,o.useRef)({keys:"",tokens:[],map:{}}),{vaultSettings:H}=(0,Se.b)({networkId:null!=(t=I?.id)?t:""}),{handleFiatCrypto:F,isSupported:W}=(0,D.TH)({accountId:null!=(n=T?.id)?n:"",networkId:null!=(i=I?.id)?i:"",fiatCryptoType:"buy"}),{handleOnReceive:U}=(0,B.m)({accountId:null!=(a=T?.id)?a:"",networkId:null!=(s=I?.id)?s:"",walletId:null!=(l=j?.id)?l:"",deriveInfo:O,deriveType:N}),{handleOnManageToken:V,manageTokenEnabled:z}=function useManageToken({accountId:e,networkId:t,walletId:n,isOthersWallet:r,indexedAccountId:i,deriveType:a}){var s=(0,_.A)(),{result:c}=(0,A.yk)((function(){return k.A.serviceNetwork.getVaultSettings({networkId:t})}),[t]),l=(0,o.useCallback)((function(){s.pushModal(R.ry.MainModal,{screen:R.jX.TokenManagerModal,params:{walletId:n,isOthersWallet:r,indexedAccountId:i,networkId:t,accountId:e,deriveType:a}})}),[s,n,r,i,t,e,a]);return{manageTokenEnabled:!c?.isSingleToken,handleOnManageToken:l}}({accountId:null!=(d=T?.id)?d:"",networkId:null!=(m=I?.id)?m:"",walletId:null!=(y=j?.id)?y:"",deriveType:N,indexedAccountId:x?.id,isOthersWallet:S}),K=(0,c.useMedia)(),q=(0,_.A)();(0,c.useOnRouterChange)((function(e){var t=e?.routes.find((function({name:e}){return e===R.WP.Modal}));t?.params?.screen===R.ry.SendModal&&t?.params?.params?.screen===R.j$.SendSelectToken||t?.params?.screen===R.ry.ReceiveModal&&t?.params?.params?.screen===R.MD.ReceiveSelectToken?C(!0):C(!1)}));var X,{refreshAllTokenList:J,refreshAllTokenListMap:Z,refreshTokenList:Y,refreshTokenListMap:ee,refreshRiskyTokenList:ne,refreshRiskyTokenListMap:re,refreshSmallBalanceTokenList:oe,refreshSmallBalanceTokenListMap:ie,refreshSmallBalanceTokensFiatValue:ae,updateTokenListState:se,updateSearchKey:ce}=(0,M.WE)().current,{updateAccountWorth:le,updateAccountOverviewState:ue}=(0,G.Lu)().current,{run:de}=(0,A.yk)((0,r.A)((function*(){try{var e,t,n,r;if(!T||!I)return;if(I.isAllNetworks)return;u.iL.emit(u.Tu.TabListStateUpdate,{isRefreshing:!0,type:p.GV.TOKENS,accountId:T.id,networkId:I.id}),yield k.A.serviceToken.abortFetchAccountTokens();var o=yield k.A.serviceToken.fetchAccountTokens({accountId:T.id,mergeTokens:!0,networkId:I.id,flag:"home-token-list"}),i=new je.A(0);if(i=i.plus(null!=(e=o.tokens.fiatValue)?e:"0").plus(null!=(t=o.riskTokens.fiatValue)?t:"0").plus(null!=(n=o.smallBalanceTokens.fiatValue)?n:"0"),ue({isRefreshing:!1,initialized:!0}),le({accountId:T.id,initialized:!0,worth:i.toFixed(),createAtNetworkWorth:i.toFixed(),merge:!1}),Y({keys:o.tokens.keys,tokens:o.tokens.data}),ee({tokens:o.tokens.map}),ne({keys:o.riskTokens.keys,riskyTokens:o.riskTokens.data}),re({tokens:o.riskTokens.map}),oe({keys:o.smallBalanceTokens.keys,smallBalanceTokens:o.smallBalanceTokens.data}),ie({tokens:o.smallBalanceTokens.map}),ae({value:null!=(r=o.smallBalanceTokens.fiatValue)?r:"0"}),o.allTokens){J({keys:o.allTokens?.keys,tokens:o.allTokens?.data}),Z({tokens:o.allTokens.map});var a=o.allTokens.data;a&&a.length&&k.A.serviceToken.updateLocalTokens({networkId:I.id,tokens:a}),se({initialized:!0,isRefreshing:!1}),u.iL.emit(u.Tu.TabListStateUpdate,{isRefreshing:!1,type:p.GV.TOKENS,accountId:T.id,networkId:I.id})}}catch(e){var s,c;if(u.iL.emit(u.Tu.TabListStateUpdate,{isRefreshing:!1,type:p.GV.TOKENS,accountId:null!=(s=T?.id)?s:"",networkId:null!=(c=I?.id)?c:""}),!(e instanceof Re))throw e}finally{v(!1)}})),[T,I,Y,ee,ne,re,oe,ie,ae,J,Z,se,v,ue,le],{overrideIsFocused:function(e){return e&&w||L},debounced:Q.EI,pollingInterval:Q.iD}),fe=(0,o.useRef)(!1),pe=(0,Xe.dh)((function(){Y({keys:P.current.keys,tokens:P.current.tokens,merge:!0,map:P.current.map,mergeDerive:!0,split:!0}),ne({keys:E.current.keys,riskyTokens:E.current.tokens,merge:!0,map:E.current.map,mergeDerive:!0}),P.current.tokens=[],P.current.keys="",P.current.map={},E.current.tokens=[],E.current.keys="",E.current.map={}}),1e3),ke=(0,o.useCallback)((X=(0,r.A)((function*({accountId:e,networkId:t,allNetworkDataInit:n}){var r=yield k.A.serviceToken.fetchAccountTokens({networkId:t,accountId:e,flag:"home-token-list",isAllNetworks:!0,isManualRefresh:fe.current,mergeTokens:!0,allNetworksAccountId:T?.id,allNetworksNetworkId:I?.id});if(!n&&r.isSameAllNetworksAccountData){var o,i,a,s,c=new je.A(0),l=new je.A(0);c=c.plus(null!=(o=r.tokens.fiatValue)?o:"0").plus(null!=(i=r.riskTokens.fiatValue)?i:"0").plus(null!=(a=r.smallBalanceTokens.fiatValue)?a:"0"),se({initialized:!0,isRefreshing:!1}),ue({isRefreshing:!1,initialized:!0}),T?.id&&(!f.A.isOthersAccount({accountId:T.id})||f.A.isOthersAccount({accountId:T.id})&&T?.createAtNetwork&&T.createAtNetwork===t)&&(l=c),le({accountId:null!=(s=T?.id)?s:"",initialized:!0,worth:c.toFixed(),createAtNetworkWorth:l.toFixed(),merge:!0});var u=!!(yield k.A.serviceNetwork.getVaultSettings({networkId:t})).mergeDeriveAssetsEnabled;P.current.tokens=P.current.tokens.concat([...r.tokens.data,...r.smallBalanceTokens.data]),P.current.keys=`${P.current.keys}_${r.tokens.keys}`;var d=TokenListContainer_objectSpread(TokenListContainer_objectSpread({},r.tokens.map),r.smallBalanceTokens.map);P.current.map=TokenListContainer_objectSpread(TokenListContainer_objectSpread({},d),P.current.map),E.current.tokens=E.current.tokens.concat([...r.riskTokens.data]),E.current.keys=`${E.current.keys}_${r.riskTokens.keys}`,E.current.map=TokenListContainer_objectSpread(TokenListContainer_objectSpread({},r.riskTokens.map),E.current.map),ee({tokens:d,merge:!0,mergeDerive:u}),ie({tokens:d,merge:!0,mergeDerive:u}),re({tokens:r.riskTokens.map,merge:!0,mergeDerive:u}),r.allTokens&&(Z({tokens:r.allTokens.map,merge:!0,mergeDerive:u}),J({keys:r.allTokens.keys,tokens:r.allTokens.data,map:r.allTokens.map,merge:!0,mergeDerive:u})),pe()}return fe.current=!1,r})),function(e){return X.apply(this,arguments)}),[T?.createAtNetwork,T?.id,I?.id,J,Z,re,ie,ee,ue,le,pe,se]),me=(0,o.useCallback)((function(){var e=(0,Je.H7)();ae({value:"0"}),J({tokens:e.allTokens.data,keys:e.allTokens.keys}),Z({tokens:e.allTokens.map}),Y({tokens:e.tokens.data,keys:e.tokens.keys}),ee({tokens:e.tokens.map}),oe({smallBalanceTokens:e.smallBalanceTokens.data,keys:e.smallBalanceTokens.keys}),ie({tokens:e.smallBalanceTokens.map}),ne({riskyTokens:e.riskTokens.data,keys:e.riskTokens.keys}),re({tokens:e.riskTokens.map})}),[J,Z,ne,re,oe,ie,ae,Y,ee]),ye=(0,o.useCallback)((function({accountId:e,networkId:t}){u.iL.emit(u.Tu.TabListStateUpdate,{isRefreshing:!1,type:p.GV.TOKENS,accountId:null!=e?e:"",networkId:null!=t?t:""})}),[]),we=(0,o.useCallback)((function({accountId:e,networkId:t}){u.iL.emit(u.Tu.TabListStateUpdate,{isRefreshing:!0,type:p.GV.TOKENS,accountId:null!=e?e:"",networkId:null!=t?t:""})}),[]),{run:he,result:Ae}=useAllNetworkRequests({account:T,network:I,wallet:j,allNetworkRequests:ke,clearAllNetworkData:me,onStarted:we,onFinished:ye,interval:200,shouldAlwaysFetch:L}),be=(0,o.useCallback)((0,r.A)((function*(){var e={tokens:[],keys:""},t={smallBalanceTokens:[],keys:""},n={riskyTokens:[],keys:""},r={},o={},i={},a=new je.A(0),s=new je.A(0),c=new je.A(0);if(Ae){var l;for(var u of Ae){var d,p,m,y,w,h,A,b=(yield k.A.serviceNetwork.getVaultSettings({networkId:null!=(d=u.networkId)?d:""})).mergeDeriveAssetsEnabled;if(e.tokens=(0,Je.JW)({sourceTokens:u.tokens.data,targetTokens:e.tokens,mergeDeriveAssets:b}),e.keys=`${e.keys}_${u.tokens.keys}`,r=(0,Je.bX)({sourceMap:u.tokens.map,targetMap:r,mergeDeriveAssets:b}),t.smallBalanceTokens=(0,Je.JW)({sourceTokens:u.smallBalanceTokens.data,targetTokens:t.smallBalanceTokens,mergeDeriveAssets:b}),t.keys=`${t.keys}_${u.smallBalanceTokens.keys}`,o=(0,Je.bX)({sourceMap:u.smallBalanceTokens.map,targetMap:o,mergeDeriveAssets:b}),n.riskyTokens=(0,Je.JW)({sourceTokens:u.riskTokens.data,targetTokens:n.riskyTokens,mergeDeriveAssets:b}),n.riskyTokens=n.riskyTokens.concat(u.riskTokens.data),n.keys=`${n.keys}_${u.riskTokens.keys}`,i=(0,Je.bX)({sourceMap:u.riskTokens.map,targetMap:i,mergeDeriveAssets:b}),a=a.plus(null!=(p=u.tokens.fiatValue)?p:"0").plus(null!=(m=u.riskTokens.fiatValue)?m:"0").plus(null!=(y=u.smallBalanceTokens.fiatValue)?y:"0"),T?.id&&(!f.A.isOthersAccount({accountId:T.id})||f.A.isOthersAccount({accountId:T.id})&&T?.createAtNetwork&&T.createAtNetwork===u.networkId))s=s.plus(null!=(w=u.tokens.fiatValue)?w:"0").plus(null!=(h=u.riskTokens.fiatValue)?h:"0").plus(null!=(A=u.smallBalanceTokens.fiatValue)?A:"0")}var g=TokenListContainer_objectSpread(TokenListContainer_objectSpread({},r),o),v=(0,Je.LQ)({tokens:[...e.tokens,...t.smallBalanceTokens],map:g}),I=v.findIndex((function(e){var t;return new je.A(null!=(t=g[e.$key]?.fiatValue)?t:0).isZero()}));if(I>-1){var j=v.slice(0,I),x=v.slice(I);x=(0,Je.q5)({tokens:x}),v=[...j,...x]}e.tokens=v.slice(0,Q.tr),t.smallBalanceTokens=v.slice(Q.tr),c=t.smallBalanceTokens.reduce((function(e,t){var n;return e.plus(null!=(n=g[t.$key].fiatValue)?n:"0")}),new je.A(0)),n.riskyTokens=(0,Je.LQ)({tokens:n.riskyTokens,map:i}),le({accountId:null!=(l=T?.id)?l:"",initialized:!0,worth:a.toFixed(),createAtNetworkWorth:s.toFixed()}),Y(e),ee({tokens:g}),oe(t),ie({tokens:g}),ae({value:c.toFixed()}),ne(n),re({tokens:i})}})),[T?.createAtNetwork,T?.id,Ae,ne,re,oe,ie,ae,Y,ee,le]);(0,o.useEffect)((function(){be()}),[be]),(0,o.useEffect)((function(){g&&de()}),[g,de]),(0,o.useEffect)((function(){T?.id&&I?.id&&j?.id&&(se({initialized:!1,isRefreshing:!0}),ce(""),k.A.serviceToken.updateCurrentAccount({networkId:I.id,accountId:T.id}),I.id!==tt.onekeyall&&me())}),[T?.id,me,I?.id,ce,se,j?.id]);var ge=(0,o.useCallback)((function(e){var t,n;T&&I&&j&&O&&q.pushModal(R.ry.MainModal,{screen:R.kZ.TokenDetails,params:{accountId:null!=(t=e.accountId)?t:T.id,networkId:null!=(n=e.networkId)?n:I.id,walletId:j.id,deriveInfo:O,deriveType:N,tokenInfo:e,isAllNetworks:I.isAllNetworks}})}),[T,O,N,q,I,j]),ve=(0,o.useMemo)((function(){return!H?.disabledSendAction&&j?.type!==$.Hk}),[H?.disabledSendAction,j?.type]),Te=(0,o.useCallback)((function(){fe.current=!0,he({alwaysSetState:!0})}),[he]);return(0,A.yk)((0,r.A)((function*(){if(T&&I&&I.isAllNetworks){var e=yield k.A.serviceHistory.getAllNetworksPendingTxs({accountId:T.id,networkId:I.id});if(!te()(e))(yield k.A.serviceHistory.fetchAccountHistory({accountId:T.id,networkId:I.id})).pendingTxsUpdated&&Te()}})),[T,Te,I],{overrideIsFocused:function(e){return e&&w},debounced:Q.EI,pollingInterval:Q.fu}),(0,o.useEffect)((function(){var refresh=function(){I?.isAllNetworks?Te():de()},fn=function(){w&&refresh()};return u.iL.on(u.Tu.RefreshTokenList,refresh),u.iL.on(u.Tu.AccountDataUpdate,fn),function(){u.iL.off(u.Tu.RefreshTokenList,refresh),u.iL.off(u.Tu.AccountDataUpdate,fn)}}),[Te,w,I?.isAllNetworks,de,he]),(0,h.jsx)(Ze.x,TokenListContainer_objectSpread({withHeader:!0,withFooter:!0,withPrice:!0,inTabList:!0,hideValue:!0,withBuyAndReceive:ve,isBuyTokenSupported:W,onBuyToken:F,onReceiveToken:U,manageTokenEnabled:z,onManageToken:V,onPressToken:ge,isAllNetworks:I?.isAllNetworks},K.gtLg&&{tableLayout:!0}))}var nt=(0,o.memo)((function(e){var t,{activeAccount:{account:n}}=(0,b.LH)({num:0});return f.A.isUrlAccountFn({accountId:null!=(t=n?.id)?t:""})?(0,h.jsx)(et,{children:(0,h.jsx)(TokenListContainer,TokenListContainer_objectSpread({showWalletActions:!0},e))}):(0,h.jsx)(L.p,{children:(0,h.jsx)(TokenListContainer,TokenListContainer_objectSpread({showWalletActions:!0},e))})}));nt.displayName="TokenListContainerWithProvider";var rt=n(232471),ot=n(124155),it=n(616552);function TxHistoryContainer_ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var at=(0,o.memo)((0,it.UK)((function TxHistoryListContainer(e){var t,{isFocused:n,isHeaderRefreshing:i,setIsHeaderRefreshing:a}=(0,c.useTabIsRefreshingFocused)(),{updateSearchKey:s}=(0,it.n8)().current,[l,d]=(0,o.useState)([]),[f,m]=(0,o.useState)({initialized:!1,isRefreshing:!1}),y=(0,o.useRef)(!1),w=(0,c.useMedia)(),g=(0,_.A)(),{activeAccount:{account:T,network:I,wallet:j}}=(0,b.LH)({num:0}),x=(0,o.useCallback)((t=(0,r.A)((function*(e){if(T&&I){if(e.decodedTx.status===rt.Y1.Pending&&e.isLocalCreated){var t=yield k.A.serviceHistory.getLocalHistoryTxById({accountId:e.decodedTx.accountId,networkId:e.decodedTx.networkId,historyId:e.id});if(!t||t.replacedNextId)return}g.pushModal(R.ry.MainModal,{screen:R.kZ.HistoryDetails,params:{networkId:e.decodedTx.networkId,accountId:e.decodedTx.accountId,historyTx:e,isAllNetworks:I.isAllNetworks}})}})),function(e){return t.apply(this,arguments)}),[T,g,I]),S=(0,o.useRef)(!1),{run:O}=(0,A.yk)((0,r.A)((function*(){if(T&&I){u.iL.emit(u.Tu.TabListStateUpdate,{isRefreshing:!0,type:p.GV.HISTORY,accountId:T.id,networkId:I.id});var e=yield k.A.serviceHistory.fetchAccountHistory({accountId:T.id,networkId:I.id,isManualRefresh:S.current});m({initialized:!0,isRefreshing:!1}),a(!1),d(e.txs),u.iL.emit(u.Tu.TabListStateUpdate,{isRefreshing:!1,type:p.GV.HISTORY,accountId:T.id,networkId:I.id}),e.pendingTxsUpdated&&u.iL.emit(u.Tu.RefreshTokenList,void 0),S.current=!1}})),[T,I,a],{overrideIsFocused:function(e){return e&&n},debounced:Q.EI,pollingInterval:Q.fu});return(0,o.useEffect)((function(){T?.id&&I?.id&&j?.id&&(m({initialized:!1,isRefreshing:!0}),s(""),y.current=!1)}),[T?.id,I?.id,s,j?.id]),(0,o.useEffect)((function(){i&&O()}),[i,O]),(0,o.useEffect)((function(){var refresh=function(){n&&(S.current=!0,O())},clearCallback=function(){return d((function(e){return e.filter((function(e){return e.decodedTx.status!==rt.Y1.Pending}))}))};return u.iL.on(u.Tu.ClearLocalHistoryPendingTxs,clearCallback),u.iL.on(u.Tu.AccountDataUpdate,refresh),function(){u.iL.off(u.Tu.ClearLocalHistoryPendingTxs,clearCallback),u.iL.off(u.Tu.AccountDataUpdate,refresh)}}),[n,O]),(0,o.useEffect)((function(){var reloadCallback=function(){return O({alwaysSetState:!0})},fn=function(){n&&O()};return u.iL.on(u.Tu.AccountDataUpdate,fn),u.iL.on(u.Tu.HistoryTxStatusChanged,reloadCallback),function(){u.iL.off(u.Tu.HistoryTxStatusChanged,reloadCallback),u.iL.off(u.Tu.AccountDataUpdate,fn)}}),[n,O]),(0,h.jsx)(ot.q,function TxHistoryContainer_objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?TxHistoryContainer_ownKeys(Object(n),!0).forEach((function(t){(0,v.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):TxHistoryContainer_ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({showIcon:!0,inTabList:!0,hideValue:!0,data:null!=l?l:[],onPressHistory:x,showHeader:!0,isLoading:f.isRefreshing,initialized:f.initialized},w.gtLg&&{tableLayout:!0}))})));const st=function LNHardwareWalletAuth({children:e,accountId:t,networkId:n}){var a=(0,i.A)(),[s,l]=(0,o.useState)(!1),[u,f]=(0,o.useState)(!1),{result:p,run:m}=(0,A.yk)((0,r.A)((function*(){try{return yield k.A.serviceLightning.checkAuth({accountId:t,networkId:n}),!0}catch{return!1}finally{l(!0)}})),[n,t]),y=(0,o.useCallback)((0,r.A)((function*(){f(!0);try{yield k.A.serviceLightning.exchangeToken({networkId:n,accountId:t}),setTimeout((function(){m()}),200)}catch(e){c.Toast.error({title:a.formatMessage({id:d.ETranslations.ln_authorize_access_network_error})})}finally{f(!1)}})),[n,t,a,m]);return s?p?(0,h.jsx)(h.Fragment,{children:e}):(0,h.jsxs)(c.Stack,{testID:"LNHardwareAuth",w:"100%",h:"100%",children:[(0,h.jsx)(L.p,{children:(0,h.jsx)(c.Stack,{testID:"Wallet-Tab-Header",p:"$5",children:(0,h.jsx)(O,{mb:"$2.5"})})}),(0,h.jsx)(c.Stack,{flex:1,testID:"LNHardware",justifyContent:"center",alignItems:"center",children:(0,h.jsx)(c.Empty,{icon:"PasswordOutline",title:a.formatMessage({id:d.ETranslations.ln_authorize_access}),description:a.formatMessage({id:d.ETranslations.ln_authorize_access_desc}),buttonProps:{children:a.formatMessage({id:d.ETranslations.global_connect_hardware_wallet}),onPress:function(){y()},loading:u}})})]}):(0,h.jsx)(c.Stack,{w:"100%",h:"100%",alignItems:"center",justifyContent:"center",children:(0,h.jsx)(c.Spinner,{size:"large"})})};var ct=n(184251);const lt=function WalletContentWithAuth({networkId:e,accountId:t,children:n}){return ct.A.isLightningNetworkByNetworkId(e)&&f.A.isHwAccount({accountId:t})?(0,h.jsx)(st,{networkId:e,accountId:t,children:n}):n};var ut;function HomePageView({onPressHide:e,sceneName:t}){var n,w,{screenWidth:v,pageWidth:T}=(0,N.A)();null==ut&&(ut=new a.A.Value(T)),(0,o.useEffect)((function(){ut&&a.A.timing(ut,{toValue:T,duration:400,easing:s.A.inOut(s.A.quad),useNativeDriver:!1}).start()}),[T]);var I=(0,i.A)(),{activeAccount:{account:j,accountName:x,network:S,deriveInfo:L,wallet:C,ready:P,device:_}}=(0,b.LH)({num:0}),[M,R]=(L?.labelKey?I.formatMessage({id:L?.labelKey}):n=L?.label,(0,o.useState)(!1)),E=(0,A.yk)((0,r.A)((function*(){var e;return S?k.A.serviceNetwork.getVaultSettings({networkId:null!=(e=S?.id)?e:""}):Promise.resolve(void 0)})),[S]).result,H=E?.NFTEnabled&&(0,l.cN)().includes(null!=(w=S?.id)?w:""),D=E?.validationRequired,$=E?.softwareAccountDisabled,F=E?.supportedDeviceTypes,B=E?.watchingAccountEnabled,W=(0,o.useMemo)((function(){return[{title:I.formatMessage({id:d.ETranslations.global_crypto}),page:(0,o.memo)(nt,(function(){return!0}))},H?{title:I.formatMessage({id:d.ETranslations.global_nft}),page:(0,o.memo)(Ce,(function(){return!0}))}:null,{title:I.formatMessage({id:d.ETranslations.global_history}),page:(0,o.memo)(at,(function(){return!0}))}].filter(Boolean)}),[I,j?.id,S?.id,H]),U=(0,o.useCallback)((function(){u.iL.emit(u.Tu.AccountDataUpdate,void 0)}),[]),V=(0,o.useCallback)((function(){return(0,h.jsx)(c.Tab,{disableRefresh:!0,data:W,ListHeaderComponent:(0,h.jsx)(HomeHeaderContainer,{}),initialScrollIndex:0,contentItemWidth:ut,contentWidth:v,showsVerticalScrollIndicator:!1,onRefresh:U})}),[W,v,U]),z=(0,o.useCallback)((function(){var e,t,n,r,o;return $&&f.A.isHdWallet({walletId:null!=(e=C?.id)?e:""})||F&&_?.deviceType&&!F.includes(_?.deviceType)?(0,h.jsx)(HomeSupportedWallet,{supportedDeviceTypes:F,watchingAccountEnabled:B}):j?D?(0,h.jsx)(lt,{networkId:null!=(r=S?.id)?r:"",accountId:null!=(o=j?.id)?o:"",children:(0,h.jsx)(h.Fragment,{children:V()})}):(0,h.jsx)(h.Fragment,{children:V()}):(0,h.jsxs)(c.YStack,{height:"100%",children:[(0,h.jsx)(O,{padding:"$5"}),(0,h.jsx)(c.Stack,{flex:1,justifyContent:"center",children:(0,h.jsx)(m.TP,{autoCreateAddress:!0,name:x,chain:null!=(t=S?.name)?t:"",type:null!=(n=L?.labelKey?I.formatMessage({id:L?.labelKey}):L?.label)?n:""})})]})}),[$,C?.id,F,_?.deviceType,j,D,V,B,x,S?.name,S?.id,L?.labelKey,L?.label,I]),K=(0,o.useCallback)((function(){if(!P)return(0,h.jsx)(y.i,{showHeaderRight:!0,sceneName:t});var e=(0,h.jsx)(c.Stack,{h:"100%",justifyContent:"center",children:(0,h.jsx)(m.Bl,{})});return C&&(e=z()),(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(y.i,{showHeaderRight:!0,sceneName:t}),(0,h.jsxs)(c.Page.Body,{children:[t===p.Zs.home?(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(UpdateReminder,{}),(0,h.jsx)(g.a,{})]}):null,e]})]})}),[P,C,t,z]);return(0,o.useMemo)((function(){return(0,h.jsx)(c.Page,{fullPage:!0,children:K()})}),[K])}}}]);