"use strict";(self.webpackChunkweb=self.webpackChunkweb||[]).push([[92736],{326745:(e,n,t)=>{t.d(n,{u:()=>useAppRoute});var r=t(654266);function useAppRoute(){return(0,r.lq)()}},338443:(e,n,t)=>{t.d(n,{m:()=>OptionList});var r=t(586330),o=t(324586),i=t(514041),a=t(908867),s=t(17617),d=t(490343),c=t(391944),l=t(498356),u=t(259227),m=t(254491),f=t(18910),g=t(831085);function ownKeys(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function _objectSpread(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?ownKeys(Object(t),!0).forEach((function(n){(0,o.A)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var b=(0,i.createContext)({}),ExtraField=function({name:e,renderItem:n,item:t}){return(0,g.jsxs)(d.XStack,{justifyContent:"space-between",children:[(0,g.jsx)(d.SizableText,{size:"$bodyMd",color:"$textSubdued",children:e}),(0,g.jsx)(d.SizableText,{size:"$bodyMd",color:"$textSubdued",children:n({item:t})})]})},OptionItem=function({item:e,token:n,network:t,onPress:r}){var[{currencyInfo:{symbol:o}}]=(0,u.useSettingsPersistAtom)(),{extraFields:l,activeId:k}=(0,i.useContext)(b),y=k===e.id,p=(0,a.A)();return(0,g.jsx)(d.Stack,{px:"$5",py:"$2",children:(0,g.jsxs)(d.YStack,_objectSpread(_objectSpread({onPress:function(){return r?.({item:e})},borderWidth:s.A.hairlineWidth,borderColor:y?"$borderActive":"$borderSubdued",borderRadius:"$3",overflow:"hidden"},f.Y),{},{children:[(0,g.jsxs)(d.XStack,{bg:"$bgSubdued",px:14,py:12,jc:"space-between",ai:"center",children:[(0,g.jsxs)(d.XStack,{children:[(0,g.jsx)(d.Stack,{pr:"$3",children:(0,g.jsx)(c.o,{tokenImageUri:n.logoURI,networkImageUri:t?.logoURI})}),(0,g.jsxs)(d.YStack,{children:[(0,g.jsx)(d.NumberSizeableText,{formatter:"balance",formatterOptions:{tokenSymbol:n?.symbol},children:e.amount}),(0,g.jsx)(d.NumberSizeableText,{size:"$bodyMd",color:"$textSubdued",formatter:"value",formatterOptions:{currency:o},children:e.fiatValue})]})]}),e.isPending?(0,g.jsx)(d.Stack,{children:(0,g.jsx)(d.Badge,{badgeType:"info",children:p.formatMessage({id:m.ETranslations.global_pending})})}):null]}),l&&l.length>0?(0,g.jsx)(d.YStack,{py:12,px:14,gap:10,children:l.map((function(n){return(0,g.jsx)(i.Suspense,{fallback:null,children:(0,g.jsx)(ExtraField,{name:n.name,renderItem:n.renderItem,item:e})},n.name)}))}):null]}))})},ListEmptyComponent=function(){var e=(0,a.A)();return(0,g.jsx)(d.Empty,{icon:"ClockTimeHistoryOutline",title:e.formatMessage({id:m.ETranslations.global_no_transactions_yet}),description:e.formatMessage({id:m.ETranslations.global_no_transactions_yet_desc})})},OptionList=function({items:e,token:n,network:t,onPress:o,onConfirmText:a,extraFields:s}){var c=(0,l.A)(),[u,m]=(0,i.useState)(e[0]?.id),[f,k]=(0,i.useState)(!1),y=(0,i.useCallback)((function({item:e}){return(0,g.jsx)(OptionItem,{item:e,token:n,network:t,onPress:function({item:e}){return m(e.id)}})}),[n,t]),p=(0,i.useCallback)((0,r.A)((function*(){var n=e.find((function(e){return e.id===u}));if(n)try{k(!0),yield o?.({item:n})}finally{k(!1)}})),[e,u,o]),v=(0,i.useMemo)((function(){return{extraFields:s,activeId:u}}),[s,u]),S=(0,i.useMemo)((function(){return!u||!e.find((function(e){return e.id===u&&!e.isPending}))}),[u,e]);return(0,g.jsx)(b.Provider,{value:v,children:(0,g.jsxs)(d.Stack,{children:[(0,g.jsx)(d.ListView,{estimatedItemSize:"$5",data:e,renderItem:y,ListEmptyComponent}),(0,g.jsx)(d.Page.Footer,{onConfirmText:a,confirmButtonProps:{onPress:p,disabled:S,loading:f},cancelButtonProps:{onPress:function(){c.pop()}}})]})})}},138584:(e,n,t)=>{t.d(n,{Py:()=>SimpleSpinnerSkeleton,am:()=>isLoadingState,bU:()=>PageFrame,o0:()=>isErrorState});var r=t(908867),o=t(490343),i=t(254491),a=t(831085),PageErrOccurred=function({onPress:e}){var n=(0,r.A)();return(0,a.jsx)(o.Empty,{icon:"ErrorOutline",title:n.formatMessage({id:i.ETranslations.global_an_error_occurred}),description:n.formatMessage({id:i.ETranslations.global_an_error_occurred_desc}),buttonProps:{onPress:e,children:n.formatMessage({id:i.ETranslations.global_refresh})}})},SimpleSpinnerSkeleton=function(){return(0,a.jsx)(o.Stack,{w:"100%",h:"$40",jc:"center",ai:"center",children:(0,a.jsx)(o.Spinner,{size:"large"})})},isLoadingState=function({result:e,isLoading:n}){return Boolean(void 0===e&&(void 0===n||!0===n))},isErrorState=function({result:e,isLoading:n}){return Boolean(void 0===e&&!1===n)},PageFrame=function({children:e,loading:n,LoadingSkeleton:t,error:r,onRefresh:o}){return n?t?(0,a.jsx)(t,{}):null:r?(0,a.jsx)(PageErrOccurred,{onPress:o}):(0,a.jsx)(a.Fragment,{children:e})}},653913:(e,n,t)=>{t.d(n,{B8:()=>useUniversalStake,D0:()=>useUniversalClaim,Pg:()=>useUniversalWithdraw});var r=t(586330),o=t(514041),i=t(610421),a=t(927799),s=t(897976),d=t(184251),c=t(714191),l=t(161024);function useUniversalStake({networkId:e,accountId:n}){var t,{navigationToSendConfirm:c}=(0,a.E)({accountId:n,networkId:e});return(0,o.useCallback)((t=(0,r.A)((function*({amount:t,symbol:r,term:o,provider:a,stakingInfo:l,onSuccess:u,onFail:m}){var f,g,b=yield i.A.serviceStaking.buildStakeTransaction({amount:t,networkId:e,accountId:n,symbol:r,term:o,provider:a}),k=yield s.rq.getVault({networkId:e,accountId:n}),y=yield k.buildStakeEncodedTx(b);d.A.isBTCNetwork(e)&&(f=!0,g=!1),yield c({encodedTx:y,stakingInfo:l,onSuccess:u,onFail:m,useFeeInTx:f,feeInfoEditable:g})})),function(e){return t.apply(this,arguments)}),[c,n,e])}function useUniversalWithdraw({networkId:e,accountId:n}){var t,{navigationToSendConfirm:d}=(0,a.E)({accountId:n,networkId:e});return(0,o.useCallback)((t=(0,r.A)((function*({amount:t,symbol:o,provider:a,identity:u,stakingInfo:m,onSuccess:f,onFail:g}){var b,k=yield i.A.serviceStaking.getStakingConfigs({networkId:e,symbol:o,provider:a});if(!k)throw new Error("Staking config not found");if(k?.unstakeWithSignMessage){var y=yield i.A.serviceAccount.getAccount({accountId:n,networkId:e}),{message:p,deadline:v}=yield i.A.serviceStaking.buildLidoEthPermitMessageData({accountId:n,networkId:e,amount:t}),S=yield i.A.serviceDApp.openSignMessageModal({accountId:n,networkId:e,request:{origin:"https://lido.fi/",scope:"ethereum"},unsignedMessage:{type:l.$.TYPED_DATA_V4,message:p,payload:[y.address,p]},sceneName:c.Zs.home});b=yield i.A.serviceStaking.buildUnstakeTransaction({amount:t,networkId:e,accountId:n,symbol:o,provider:a,signature:S,deadline:v})}else b=yield i.A.serviceStaking.buildUnstakeTransaction({amount:t,identity:u,networkId:e,accountId:n,symbol:o,provider:a});var I,h=yield s.rq.getVault({networkId:e,accountId:n}),x=yield h.buildStakeEncodedTx(b);yield d({encodedTx:x,stakingInfo:m,signOnly:k?.withdrawSignOnly,onSuccess:(I=(0,r.A)((function*(t){if(k?.withdrawSignOnly){var r=t[0].signedTx.finalizedPsbtHex;r&&u&&(yield i.A.serviceStaking.unstakePush({txId:u,networkId:e,accountId:n,symbol:o,provider:a,unstakeTxHex:r}),f?.(t))}else f?.(t)})),function onSuccess(e){return I.apply(this,arguments)}),onFail:g})})),function(e){return t.apply(this,arguments)}),[n,e,d])}function useUniversalClaim({networkId:e,accountId:n}){var t,{navigationToSendConfirm:d}=(0,a.E)({accountId:n,networkId:e});return(0,o.useCallback)((t=(0,r.A)((function*({identity:t,amount:r,provider:o,symbol:a,stakingInfo:c,onSuccess:l,onFail:u}){var m=yield i.A.serviceStaking.buildClaimTransaction({networkId:e,accountId:n,symbol:a,provider:o,amount:r,identity:t}),f=yield s.rq.getVault({networkId:e,accountId:n}),g=yield f.buildStakeEncodedTx(m);yield d({encodedTx:g,stakingInfo:c,onSuccess:l,onFail:u})})),function(e){return t.apply(this,arguments)}),[d,n,e])}},292736:(e,n,t)=>{t.r(n),t.d(n,{default:()=>__WEBPACK_DEFAULT_EXPORT__});var r=t(586330),o=t(514041),i=t(908867),a=t(490343),s=t(610421),d=t(498356),c=t(326745),l=t(911998),u=t(254491),m=t(157572),f=t(491180),g=t(184251),b=t(550082),k=t(338443),y=t(138584),p=t(653913),v=t(905817),S=t(831085);const __WEBPACK_DEFAULT_EXPORT__=function(){var e,n=(0,c.u)(),t=(0,d.A)(),{accountId:I,networkId:h,symbol:x,provider:w,details:j}=n.params,{result:T,isLoading:A,run:P}=(0,l.yk)((function(){return s.A.serviceStaking.getClaimableList({networkId:h,accountId:I,symbol:x,provider:w})}),[I,h,x,w],{watchLoading:!0}),C=(0,p.D0)({accountId:I,networkId:h}),E=(0,o.useCallback)((e=(0,r.A)((function*({item:e}){yield C({identity:e.id,symbol:j.token.info.symbol,provider:w,stakingInfo:{label:b.D.Claim,protocol:w,send:{token:j.token.info,amount:e.amount},tags:[(0,v.Y)(j)]},onSuccess:function(){t.pop(),m.U.staking.page.unstaking({token:j.token.info,stakingProtocol:w}),"babylon"===w&&s.A.serviceStaking.babylonClaimRecord({accountId:I,networkId:h,provider:w,symbol:x,identity:e.id})}})})),function(n){return e.apply(this,arguments)}),[t,j,C,w,I,h,x]),_=(0,i.A)();return(0,S.jsxs)(a.Page,{scrollEnabled:!0,children:[(0,S.jsx)(a.Page.Header,{title:_.formatMessage({id:u.ETranslations.earn_select_a_claimable_order})}),(0,S.jsx)(a.Page.Body,{children:(0,S.jsx)(y.bU,{LoadingSkeleton:y.Py,loading:(0,y.am)({result:T,isLoading:A}),error:(0,y.o0)({result:T,isLoading:A}),onRefresh:P,children:T?(0,S.jsx)(k.m,{items:T.items,token:T.token,network:T.network,onPress:E,onConfirmText:_.formatMessage({id:u.ETranslations.earn_claim}),extraFields:g.A.isBTCNetwork(h)?[{name:_.formatMessage({id:u.ETranslations.global_status}),renderItem:()=>_.formatMessage({id:u.ETranslations.earn_claimable})},{name:_.formatMessage({id:u.ETranslations.global_transaction_id}),renderItem:({item:e})=>f.A.shortenAddress({address:e.id})}]:void 0}):null})})]})}},905817:(e,n,t)=>{t.d(n,{FZ:()=>countDecimalPlaces,Y:()=>buildLocalTxStatusSyncId,c:()=>capitalizeString});var buildLocalTxStatusSyncId=function(e){return`${e.provider.name.toLowerCase()}-${e.token.info.symbol.toLowerCase()}`};function capitalizeString(e){return e?e.charAt(0).toUpperCase()+e.slice(1):e}function countDecimalPlaces(e){var n="string"==typeof e?Number(e):e;if(Number.isNaN(n))return 0;var t=n.toString(),r=t.indexOf(".");return-1===r?0:t.length-r-1}},550082:(e,n,t)=>{t.d(n,{D:()=>r});var r=function(e){return e.Stake="Stake",e.Claim="Claim",e.Redeem="Redeem",e.Withdraw="Withdraw",e.Unknown="Unknown",e}({});!function(e){e.EthEvertStake="eth-evert-stake",e.EthLido="eth-lido",e.BtcBabylon="btc-babylon"}({})}}]);