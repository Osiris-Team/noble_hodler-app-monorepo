"use strict";(self.webpackChunkweb=self.webpackChunkweb||[]).push([[24879],{224879:(e,t,n)=>{n.r(t),n.d(t,{default:()=>$,tabGridRefs:()=>S});var o=n(324586),r=n(514041),i=n(908867),s=n(17617),a=n(490343),l=n(498356),c=n(657412),d=n(254491),u=n(392097),b=n(574319),m=n(831085);const f=function MobileTabListItem({id:e,activeTabId:t,onSelectedItem:n,onCloseItem:o,onLongPress:r}){var{tab:i}=(0,b.D$)(e),l=t===e;return(0,m.jsx)(a.Stack,{width:"100%",onPress:function(){n(e)},onLongPress:function(){r(e)},p:"$1",animation:"quick",pressStyle:{scale:.95},testID:`tab-modal-list-item-${e}`,children:(0,m.jsx)(a.Stack,{borderRadius:"$4",borderWidth:"$1",borderColor:l?"$brand6":"$transparent",p:"$0.5",borderCurve:"continuous",testID:l?`tab-modal-active-item-${e}`:`tab-modal-no-active-item-${e}`,children:(0,m.jsxs)(a.Group,{borderRadius:"$2.5",borderWidth:s.A.hairlineWidth,borderColor:"$borderSubdued",separator:(0,m.jsx)(a.Divider,{}),children:[(0,m.jsx)(a.Group.Item,{children:(0,m.jsxs)(a.XStack,{py:"$2",pl:"$2.5",pr:"$2",alignItems:"center",bg:"$bgSubdued",borderCurve:"continuous",children:[(0,m.jsxs)(a.Image,{size:"$4",borderRadius:"$1",children:[(0,m.jsx)(a.Image.Source,{src:i?.favicon}),(0,m.jsx)(a.Image.Fallback,{children:(0,m.jsx)(a.Icon,{name:"GlobusOutline",size:"$4"})}),(0,m.jsx)(a.Image.Loading,{children:(0,m.jsx)(a.Skeleton,{width:"100%",height:"100%"})})]}),(0,m.jsx)(a.SizableText,{flex:1,size:"$bodySm",textAlign:"left",numberOfLines:1,mx:"$2",children:i?.title||""}),(0,m.jsx)(a.IconButton,{variant:"tertiary",size:"small",icon:"CrossedSmallOutline",onPress:function(){return o(e)},testID:`tab-modal-header-close-${e}`})]})}),(0,m.jsx)(a.Group.Item,{children:(0,m.jsx)(a.Stack,{pb:"100%",children:(0,m.jsx)(a.Stack,{position:"absolute",left:0,top:0,right:0,bottom:0,children:(0,m.jsx)(a.Image,{w:"100%",h:"100%",borderBottomLeftRadius:10,borderBottomRightRadius:10,children:(0,m.jsx)(a.Image.Source,{source:{uri:i?.thumbnail}})})})})})]})})})};const p=function MobileTabListPinnedItem({id:e,activeTabId:t,onSelectedItem:n,onLongPress:o}){var{tab:r}=(0,b.D$)(e),i=t===e;return(0,m.jsx)(a.Stack,{p:"$0.5",minWidth:"$28",maxWidth:"$40",borderRadius:"$4",borderWidth:4,borderColor:i?"$brand6":"$transparent",marginHorizontal:2,onPress:function(){n(e)},onLongPress:function(){o(e)},animation:"quick",pressStyle:{scale:.95},children:(0,m.jsxs)(a.XStack,{bg:"$bgStrong",p:"$2",alignItems:"center",borderRadius:"$2.5",testID:`tab-list-stack-pinned-${e}`,children:[(0,m.jsxs)(a.Image,{size:"$4",borderRadius:"$1",children:[(0,m.jsx)(a.Image.Source,{src:r?.favicon}),(0,m.jsx)(a.Image.Fallback,{delayMs:100,children:(0,m.jsx)(a.Icon,{name:"GlobusOutline",size:"$4"})}),(0,m.jsx)(a.Image.Loading,{children:(0,m.jsx)(a.Skeleton,{width:"100%",height:"100%"})})]}),(0,m.jsx)(a.SizableText,{flex:1,size:"$bodySm",numberOfLines:1,ml:"$2",children:r?.title||""})]})})};var h=n(416526),g=n(670656),x=(h.A.get("window").width,h.A.get("window").width,g.A.get(),n(684358)),j=n(663522);const k=function useBrowserOptionsAction(){return{handleShareUrl:(0,r.useCallback)((function(e){if(!e)throw new Error("url is required");setTimeout((function(){x.A.share(j.Ay.isNativeIOS?{url:e}:{message:e})}),300)}),[])}};var I=n(564452);function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){(0,o.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var S={};function TabToolBar({closeAllDisabled:e,onAddTab:t,onCloseAll:n,onDone:o}){var r=(0,i.A)();return(0,m.jsxs)(a.Stack,{py:"$2",flexDirection:"row",alignItems:"center",borderTopWidth:s.A.hairlineWidth,borderTopColor:"$borderSubdued",children:[(0,m.jsx)(a.Stack,{flex:1,alignItems:"center",justifyContent:"center",children:(0,m.jsx)(a.Button,{variant:"tertiary",size:"medium",onPress:n,disabled:e,testID:"tab-list-modal-close-all",children:r.formatMessage({id:d.ETranslations.explore_close_all})})}),(0,m.jsx)(a.Stack,{flex:1,alignItems:"center",justifyContent:"center",children:(0,m.jsx)(a.IconButton,{variant:"secondary",size:"medium",icon:"PlusLargeOutline",testID:"browser-bar-add",onPress:t})}),(0,m.jsx)(a.Stack,{flex:1,alignItems:"center",justifyContent:"center",children:(0,m.jsx)(a.Button,{variant:"tertiary",size:"medium",onPress:o,testID:"tab-list-modal-done",children:r.formatMessage({id:d.ETranslations.global_done})})})]})}const $=(0,I.k)((function MobileTabListModal(){var e,t=(0,i.A)(),n=(0,l.A)(),{tabs:o}=(0,b.oM)(),s=(0,r.useMemo)((function(){return(null!=o?o:[]).filter((function(e){return!e.isPinned}))}),[o]),h=(0,r.useMemo)((function(){return(null!=o?o:[]).filter((function(e){return e.isPinned}))}),[o]),{disabledAddedNewTab:g}=(0,b.bI)(),{activeTabId:x}=(0,b.cf)(),{addBrowserBookmark:j,removeBrowserBookmark:I}=(0,c.Gd)().current,{closeAllWebTabs:S,setCurrentWebTab:$,closeWebTab:T,setPinnedTab:P,setDisplayHomePage:w}=(0,c.AO)().current,v=(0,r.useRef)(!1);(0,r.useEffect)((function(){v.current&&!o.length&&(w(!0),n.pop()),v.current=!1}),[o,w,n]);var y=(0,r.useMemo)((function(){return s.findIndex((function(e){return e.id===x}))}),[s,x]),_=(0,r.useMemo)((function(){return h.findIndex((function(e){return e.id===x}))}),[h,x]),{handleShareUrl:C}=k(),O=(0,r.useCallback)((function(e,n,o){e?j({url:n,title:o}):I(n),a.Toast.success({title:e?t.formatMessage({id:d.ETranslations.explore_toast_bookmark_added}):t.formatMessage({id:d.ETranslations.explore_toast_bookmark_removed})})}),[j,I,t]),M=(0,r.useCallback)((function(e){C(e)}),[C]),D=(0,r.useCallback)((function(e,n){P({id:e,pinned:n}),a.Toast.success({title:n?t.formatMessage({id:d.ETranslations.explore_toast_pinned}):t.formatMessage({id:d.ETranslations.explore_toast_unpinned})})}),[P,t]),A=(0,r.useCallback)((function(e){v.current=!0,T(e)}),[T]),E=(0,r.useCallback)((function(){g?a.Toast.message({title:t.formatMessage({id:d.ETranslations.explore_toast_tab_limit_reached},{number:"20"})}):(n.pop(),setTimeout((function(){n.pushModal(u.ry.DiscoveryModal,{screen:u.v1.SearchModal})}),0))}),[g,n,t]),B=(0,r.useCallback)((function(e,n){a.ActionList.show({title:t.formatMessage({id:d.ETranslations.explore_options}),sections:[{items:[{label:t.formatMessage({id:e.isBookmark?d.ETranslations.explore_remove_bookmark:d.ETranslations.explore_add_bookmark}),icon:e.isBookmark?"StarSolid":"StarOutline",onPress:function(){var t;return O(!e.isBookmark,e.url,null!=(t=e.title)?t:"")},testID:"action-list-item-"+(e.isBookmark?"remove-bookmark":"bookmark")},{label:t.formatMessage({id:e.isPinned?d.ETranslations.explore_unpin:d.ETranslations.explore_pin}),icon:e.isPinned?"ThumbtackSolid":"ThumbtackOutline",onPress:function(){return D(n,!e.isPinned)},testID:"action-list-item-"+(e.isPinned?"un-pin":"pin")},{label:t.formatMessage({id:d.ETranslations.explore_share}),icon:"ShareOutline",onPress:function(){return M(e.url)},testID:"action-list-item-share"}]},{items:[{label:t.formatMessage({id:e.isPinned?d.ETranslations.explore_close_pin_tab:d.ETranslations.explore_close_tab}),icon:"CrossedLargeOutline",onPress:function(){return A(n)},testID:"action-list-item-close-"+(e.isPinned?"close-pin-tab":"close-tab")}]}]})}),[O,D,M,A,t]),z=(0,r.useCallback)((function(e){return e.id}),[]),L=(0,r.useCallback)((function({item:e}){return(0,m.jsx)(f,_objectSpread(_objectSpread({},e),{},{activeTabId:x,onSelectedItem:function(e){$(e),n.pop()},onCloseItem:A,onLongPress:function(t){B(e,t)}}))}),[x,A,$,n,B]),R=(0,r.useCallback)((function({item:e}){return(0,m.jsx)(p,_objectSpread(_objectSpread({},e),{},{activeTabId:x,onSelectedItem:function(e){$(e),n.pop()},onCloseItem:A,onLongPress:function(t){B(e,t)}}))}),[n,$,x,A,B]),W=(0,r.useMemo)((function(){return 0===h.length?null:(0,m.jsx)(a.BlurView,{position:"absolute",left:"$2.5",bottom:"$2.5",right:"$2.5",borderRadius:"$5",bg:"$bgStrong",testID:"tab-pined-container",experimentalBlurMethod:"none",children:(0,m.jsx)(a.ListView,{contentContainerStyle:{p:"$1"},horizontal:!0,data:h,showsHorizontalScrollIndicator:!1,keyExtractor:function(e){return e.id},estimatedItemSize:"$28",estimatedListSize:{width:370,height:52},renderItem:R,initialScrollIndex:_})})}),[h,R,_]);return(0,m.jsxs)(a.Page,{children:[(0,m.jsx)(a.Page.Header,{title:t.formatMessage({id:d.ETranslations.explore_tabs_count},{number:`${null!=(e=o.length)?e:0}`})}),(0,m.jsxs)(a.Page.Body,{children:[(0,m.jsx)(a.ListView,{initialScrollIndex:y,estimatedItemSize:223,data:s,renderItem:L,keyExtractor:z,numColumns:2,showsHorizontalScrollIndicator:!1,showsVerticalScrollIndicator:!1,contentContainerStyle:{paddingHorizontal:10,paddingBottom:62},testID:"tab-container"}),W]}),(0,m.jsx)(a.Page.Footer,{children:(0,m.jsx)(TabToolBar,{closeAllDisabled:s.length<=0,onAddTab:E,onCloseAll:function(){v.current=!0,S()},onDone:function(){n.pop()}})})]})}))}}]);