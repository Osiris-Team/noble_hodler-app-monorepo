"use strict";(self.webpackChunkweb=self.webpackChunkweb||[]).push([[92210],{326745:(e,n,t)=>{t.d(n,{u:()=>useAppRoute});var i=t(654266);function useAppRoute(){return(0,i.lq)()}},939799:(e,n,t)=>{t.d(n,{A:()=>ValuePriceListItem});var i=t(490343),a=t(831085),ValuePriceListItem=function({amount:e,tokenSymbol:n,fiatSymbol:t,fiatValue:o}){return(0,a.jsxs)(i.XStack,{gap:"$1",maxWidth:"$56",justifyContent:"flex-end",flexWrap:"wrap",children:[(0,a.jsx)(i.XStack,{children:(0,a.jsx)(i.NumberSizeableText,{size:"$bodyLgMedium",formatter:"balance",formatterOptions:{tokenSymbol:n},children:e})}),(0,a.jsx)(i.XStack,{maxWidth:"$56",children:o?(0,a.jsxs)(i.SizableText,{children:["(",(0,a.jsx)(i.NumberSizeableText,{size:"$bodyLgMedium",formatter:"value",formatterOptions:{currency:t},children:o}),")"]}):null})]})}},90393:(e,n,t)=>{t.d(n,{Z:()=>useProviderLabel});var i=t(908867),a=t(254491),useProviderLabel=function(e){var n=(0,i.A)(),t=n.formatMessage({id:a.ETranslations.global_protocol});return"everstake"===e.toLowerCase()?t=n.formatMessage({id:a.ETranslations.earn_validator}):"babylogn"===e.toLowerCase()&&(t=n.formatMessage({id:a.ETranslations.earn_finality_provider})),t}},653913:(e,n,t)=>{t.d(n,{B8:()=>useUniversalStake,D0:()=>useUniversalClaim,Pg:()=>useUniversalWithdraw});var i=t(586330),a=t(514041),o=t(610421),r=t(927799),s=t(897976),l=t(184251),c=t(714191),d=t(161024);function useUniversalStake({networkId:e,accountId:n}){var t,{navigationToSendConfirm:c}=(0,r.E)({accountId:n,networkId:e});return(0,a.useCallback)((t=(0,i.A)((function*({amount:t,symbol:i,term:a,provider:r,stakingInfo:d,onSuccess:u,onFail:m}){var f,k,g=yield o.A.serviceStaking.buildStakeTransaction({amount:t,networkId:e,accountId:n,symbol:i,term:a,provider:r}),b=yield s.rq.getVault({networkId:e,accountId:n}),p=yield b.buildStakeEncodedTx(g);l.A.isBTCNetwork(e)&&(f=!0,k=!1),yield c({encodedTx:p,stakingInfo:d,onSuccess:u,onFail:m,useFeeInTx:f,feeInfoEditable:k})})),function(e){return t.apply(this,arguments)}),[c,n,e])}function useUniversalWithdraw({networkId:e,accountId:n}){var t,{navigationToSendConfirm:l}=(0,r.E)({accountId:n,networkId:e});return(0,a.useCallback)((t=(0,i.A)((function*({amount:t,symbol:a,provider:r,identity:u,stakingInfo:m,onSuccess:f,onFail:k}){var g,b=yield o.A.serviceStaking.getStakingConfigs({networkId:e,symbol:a,provider:r});if(!b)throw new Error("Staking config not found");if(b?.unstakeWithSignMessage){var p=yield o.A.serviceAccount.getAccount({accountId:n,networkId:e}),{message:y,deadline:v}=yield o.A.serviceStaking.buildLidoEthPermitMessageData({accountId:n,networkId:e,amount:t}),S=yield o.A.serviceDApp.openSignMessageModal({accountId:n,networkId:e,request:{origin:"https://lido.fi/",scope:"ethereum"},unsignedMessage:{type:d.$.TYPED_DATA_V4,message:y,payload:[p.address,y]},sceneName:c.Zs.home});g=yield o.A.serviceStaking.buildUnstakeTransaction({amount:t,networkId:e,accountId:n,symbol:a,provider:r,signature:S,deadline:v})}else g=yield o.A.serviceStaking.buildUnstakeTransaction({amount:t,identity:u,networkId:e,accountId:n,symbol:a,provider:r});var I,h=yield s.rq.getVault({networkId:e,accountId:n}),x=yield h.buildStakeEncodedTx(g);yield l({encodedTx:x,stakingInfo:m,signOnly:b?.withdrawSignOnly,onSuccess:(I=(0,i.A)((function*(t){if(b?.withdrawSignOnly){var i=t[0].signedTx.finalizedPsbtHex;i&&u&&(yield o.A.serviceStaking.unstakePush({txId:u,networkId:e,accountId:n,symbol:a,provider:r,unstakeTxHex:i}),f?.(t))}else f?.(t)})),function onSuccess(e){return I.apply(this,arguments)}),onFail:k})})),function(e){return t.apply(this,arguments)}),[n,e,l])}function useUniversalClaim({networkId:e,accountId:n}){var t,{navigationToSendConfirm:l}=(0,r.E)({accountId:n,networkId:e});return(0,a.useCallback)((t=(0,i.A)((function*({identity:t,amount:i,provider:a,symbol:r,stakingInfo:c,onSuccess:d,onFail:u}){var m=yield o.A.serviceStaking.buildClaimTransaction({networkId:e,accountId:n,symbol:r,provider:a,amount:i,identity:t}),f=yield s.rq.getVault({networkId:e,accountId:n}),k=yield f.buildStakeEncodedTx(m);yield l({encodedTx:k,stakingInfo:c,onSuccess:d,onFail:u})})),function(e){return t.apply(this,arguments)}),[l,n,e])}},992210:(e,n,t)=>{t.r(n),t.d(n,{default:()=>Claim});var i=t(586330),a=t(514041),o=t(908867),r=t(490343),s=t(498356),l=t(326745),c=t(254491),d=t(157572),u=t(550082),m=t(241440),f=t(88803),k=t(791088),g=t(259227),b=t(905817),p=t(939799),y=t(831085),v={color:"$textSubdued",size:"$bodyLg"},UniversalClaim=function({balance:e,price:n,tokenImageUri:t,tokenSymbol:s,providerLogo:l,providerName:d,providerLabel:u,initialAmount:S,minAmount:I="0",rate:h="1",decimals:x,onConfirm:w}){var A=Number(n)>0?n:"0",[T,C]=(0,a.useState)(!1),[j,E]=(0,a.useState)(null!=S?S:""),[{currencyInfo:{symbol:$}}]=(0,g.useSettingsPersistAtom)(),M=(0,a.useCallback)((0,i.A)((function*(){try{C(!0),yield w?.(j)}finally{C(!1)}})),[j,w]),P=(0,a.useCallback)((function(e){if(new m.A(e).isNaN())""===e&&E("");else{var n=Boolean(x&&Number(x)>0&&(0,b.FZ)(e)>x);E(n?function(e){return e}:e)}}),[x]),N=(0,a.useMemo)((function(){var e=new m.A(j);if(!e.isNaN())return e.multipliedBy(A).toFixed()}),[j,A]),U=(0,a.useMemo)((function(){return new m.A(j).gt(e)}),[j,e]),L=(0,a.useMemo)((function(){var e=new m.A(I),n=new m.A(j);return!(!e.isGreaterThan(0)||!n.isGreaterThan(0))&&n.isLessThan(e)}),[I,j]),_=(0,a.useCallback)((function(){P(e)}),[P,e]),F=(0,a.useMemo)((function(){return(0,m.A)(j).isNaN()||(0,m.A)(j).isLessThanOrEqualTo(0)||U||L}),[j,U,L]),z=(0,a.useMemo)((function(){if(Number(j)>0){var e=(0,m.A)(j).dividedBy(h);return(0,y.jsx)(p.A,{amount:e.toFixed(),fiatSymbol:$,fiatValue:Number(A)>0?e.multipliedBy(A).dividedBy(h).toFixed():void 0,tokenSymbol:null!=s?s:""})}return null}),[j,A,s,h,$]),B=(0,o.A)(),D=void 0===S;return(0,y.jsxs)(r.YStack,{children:[(0,y.jsxs)(r.Stack,{mx:"$2",px:"$3",gap:"$5",children:[(0,y.jsxs)(r.Stack,{position:"relative",opacity:D?1:.7,children:[(0,y.jsx)(f.J,{bg:D?"$bgApp":"$bgDisabled",hasError:U||L,value:j,onChange:P,tokenSelectorTriggerProps:{selectedTokenImageUri:t,selectedTokenSymbol:s},inputProps:{placeholder:"0"},balanceProps:{value:e,onPress:_},valueProps:{value:N,currency:N?$:void 0}}),D?null:(0,y.jsx)(r.Stack,{position:"absolute",w:"100%",h:"100%"})]}),(0,y.jsxs)(r.YStack,{gap:"$1",children:[L?(0,y.jsx)(r.Alert,{icon:"InfoCircleOutline",type:"critical",title:B.formatMessage({id:c.ETranslations.earn_minimum_amount},{number:`${I} ${null!=s?s:""}`})}):null,U?(0,y.jsx)(r.Alert,{icon:"InfoCircleOutline",type:"critical",title:B.formatMessage({id:c.ETranslations.earn_insufficient_claimable_balance})}):null]})]}),(0,y.jsxs)(r.YStack,{children:[z?(0,y.jsx)(k.c,{title:B.formatMessage({id:c.ETranslations.earn_receive}),titleProps:v,children:z}):null,d&&l?(0,y.jsx)(k.c,{title:null!=u?u:B.formatMessage({id:c.ETranslations.global_protocol}),titleProps:v,children:(0,y.jsxs)(r.XStack,{gap:"$2",alignItems:"center",children:[(0,y.jsx)(r.Image,{width:"$5",height:"$5",src:l,borderRadius:"$2"}),(0,y.jsx)(r.SizableText,{size:"$bodyLgMedium",children:(0,b.c)(d)})]})}):null]}),(0,y.jsx)(r.Page.Footer,{onConfirmText:B.formatMessage({id:c.ETranslations.earn_claim}),confirmButtonProps:{onPress:M,loading:T,disabled:F}})]})},S=t(90393),I=t(653913);const Claim=function(){var e,n,t=(0,o.A)(),m=(0,l.u)(),{accountId:f,networkId:k,details:g,amount:p,identity:v,onSuccess:h}=m.params,{token:x,provider:w}=g,{price:A,info:T}=x,C=(0,b.Y)(g),j=(0,s.A)(),E=(0,I.D0)({accountId:f,networkId:k}),$=(0,a.useCallback)((n=(0,i.A)((function*(e){yield E({amount:e,identity:v,symbol:T.symbol,provider:w.name,stakingInfo:{label:u.D.Claim,protocol:w.name,send:{token:T,amount:e},tags:[C]},onSuccess:function(){j.pop(),d.U.staking.page.unstaking({token:T,stakingProtocol:w.name}),h?.()}})})),function(e){return n.apply(this,arguments)}),[E,T,j,w,C,v,h]),M=(0,S.Z)(w.name);return(0,y.jsxs)(r.Page,{children:[(0,y.jsx)(r.Page.Header,{title:t.formatMessage({id:c.ETranslations.earn_claim_token},{token:x.info.symbol})}),(0,y.jsx)(r.Page.Body,{children:(0,y.jsx)(UniversalClaim,{price:A,decimals:g.token.info.decimals,initialAmount:p,balance:null!=(e=g.claimable)?e:"0",tokenSymbol:T.symbol,tokenImageUri:T.logoURI,providerLogo:w.logoURI,providerName:w.name,providerLabel:M,onConfirm:$})})]})}},905817:(e,n,t)=>{t.d(n,{FZ:()=>countDecimalPlaces,Y:()=>buildLocalTxStatusSyncId,c:()=>capitalizeString});var buildLocalTxStatusSyncId=function(e){return`${e.provider.name.toLowerCase()}-${e.token.info.symbol.toLowerCase()}`};function capitalizeString(e){return e?e.charAt(0).toUpperCase()+e.slice(1):e}function countDecimalPlaces(e){var n="string"==typeof e?Number(e):e;if(Number.isNaN(n))return 0;var t=n.toString(),i=t.indexOf(".");return-1===i?0:t.length-i-1}},550082:(e,n,t)=>{t.d(n,{D:()=>i});var i=function(e){return e.Stake="Stake",e.Claim="Claim",e.Redeem="Redeem",e.Withdraw="Withdraw",e.Unknown="Unknown",e}({});!function(e){e.EthEvertStake="eth-evert-stake",e.EthLido="eth-lido",e.BtcBabylon="btc-babylon"}({})}}]);