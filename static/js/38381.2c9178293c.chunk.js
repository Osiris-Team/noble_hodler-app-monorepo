"use strict";(self.webpackChunkweb=self.webpackChunkweb||[]).push([[38381],{738381:(e,t,i)=>{i.r(t),i.d(t,{default:()=>v});var r=i(586330),s=i(514041),n=i(654266),a=i(908867),o=i(17617),d=i(490343),l=i(391944),c=i(259227),u=i(318822),f=i(254491),h=i(157572),g=i(491180),m=i(901976),y=i(100645),b=i(610421),w=i(298254),x=function(e){return e[e.Unverified=0]="Unverified",e[e.Verifying=1]="Verifying",e[e.Verified=2]="Verified",e[e.ForceShow=3]="ForceShow",e}({}),p=i(831085);const v=function ReceiveToken(){(0,m.e)({name:"ReceiveToken9971"});var e=(0,a.A)(),t=(0,n.lq)(),{networkId:i,accountId:v,walletId:$,token:S}=t.params,{account:T,network:j,wallet:k,vaultSettings:_,addressType:I,deriveType:C}=(0,w.b)({accountId:v,networkId:i,walletId:$}),[A,E]=(0,s.useState)(x.Unverified),[U]=(0,c.useHardwareUiStateAtom)(),{copyText:M}=(0,d.useClipboard)(),R=g.A.isQrWallet({walletId:$})||g.A.isHwWallet({walletId:$}),V=(0,s.useMemo)((function(){return!R||(A===x.ForceShow||A===x.Verified||A===x.Verifying&&U?.action===c.EHardwareUiStateAction.REQUEST_BUTTON)}),[A,U?.action,R]),z=(0,s.useMemo)((function(){if(A===x.Verifying&&U?.action===c.EHardwareUiStateAction.REQUEST_BUTTON)return!0}),[A,U?.action]),B=(0,s.useMemo)((function(){return!R||(A===x.ForceShow||A===x.Verified)}),[A,R]),H=A===x.Verifying,F=(0,s.useCallback)((0,r.A)((function*(){E(x.Verifying);try{if(!C)return;var t=yield b.A.serviceAccount.verifyHWAccountAddresses({walletId:$,networkId:i,indexedAccountId:T?.indexedAccountId,deriveType:C,confirmOnDevice:y.hz.EveryItem}),r=t?.[0]?.toLowerCase()===T?.address?.toLowerCase();h.U.transaction.receive.showReceived({walletType:k?.type,isSuccess:r,failedReason:r?"":e.formatMessage({id:f.ETranslations.feedback_address_mismatch})}),r||d.Toast.error({title:e.formatMessage({id:f.ETranslations.feedback_address_mismatch}),message:e.formatMessage({id:f.ETranslations.feedback_address_mismatch_desc})}),E(r?x.Verified:x.Unverified)}catch(e){throw E(x.Unverified),h.U.transaction.receive.showReceived({walletType:k?.type,isSuccess:!1,failedReason:e.message}),e}})),[T?.address,T?.indexedAccountId,C,e,i,k?.type,$]);(0,s.useEffect)((function(){var callback=function(){return E(x.Unverified)};return u.iL.on(u.Tu.CloseHardwareUiStateDialogManually,callback),function(){u.iL.off(u.Tu.CloseHardwareUiStateDialogManually,callback)}}),[]),(0,s.useEffect)((function(){R||h.U.transaction.receive.showReceived({walletType:k?.type,isSuccess:!0,failedReason:""})}),[R,k?.type]);var O=(0,s.useCallback)((function(){return R?A===x.Verified||A===x.ForceShow||H?(0,p.jsx)(d.Button,{mt:"$5",icon:"Copy1Outline",disabled:H,loading:H,onPress:function(){var e;return M(null!=(e=T?.address)?e:"")},children:e.formatMessage({id:f.ETranslations.global_copy_address})}):(0,p.jsxs)(d.YStack,{gap:"$5",alignItems:"center",children:[(0,p.jsx)(d.Button,{mt:"$5",variant:"primary",onPress:F,children:e.formatMessage({id:f.ETranslations.global_verify_on_device})}),(0,p.jsx)(d.Button,{size:"medium",variant:"tertiary",onPress:function(){return E(x.ForceShow)},children:e.formatMessage({id:f.ETranslations.skip_verify_text})})]}):(0,p.jsx)(d.Button,{mt:"$5",icon:"Copy1Outline",onPress:function(){var e;return M(null!=(e=T?.address)?e:"")},children:e.formatMessage({id:f.ETranslations.global_copy_address})})}),[T?.address,A,M,F,e,R,H]),P=(0,s.useCallback)((function(){var t;return T&&j&&k?(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)(d.Stack,{mb:"$5",children:[(0,p.jsxs)(d.XStack,{gap:"$2",alignItems:"center",justifyContent:"center",children:[(0,p.jsx)(d.Heading,{size:"$headingMd",children:null!=(t=S?.symbol)?t:j.symbol}),_?.showAddressType&&I?(0,p.jsx)(d.Badge,{children:I}):null]}),(0,p.jsx)(d.SizableText,{mt:"$1",size:"$bodyMd",color:"$textSubdued",textAlign:"center",children:e.formatMessage({id:f.ETranslations.receive_send_asset_warning_message},{network:j.name})})]}),(0,p.jsxs)(d.Stack,{borderRadius:"$3",borderWidth:o.A.hairlineWidth,borderColor:"$borderSubdued",p:"$4",children:[(0,p.jsxs)(d.Stack,{position:"relative",children:[(0,p.jsx)(d.QRCode,{value:T.address,size:240}),(0,p.jsx)(d.Stack,{position:"absolute",width:"100%",height:"100%",justifyContent:"center",alignItems:"center",children:(0,p.jsx)(d.Stack,{p:5,borderRadius:"$full",overflow:"hidden",bg:"$bgApp",children:(0,p.jsx)(l.o,{size:"lg",tokenImageUri:S?.logoURI||j.logoURI})})})]}),B?null:(0,p.jsxs)(d.Stack,{position:"absolute",top:"$0",left:"$0",right:"$0",bottom:"$0",alignItems:"center",justifyContent:"center",children:[(0,p.jsx)(d.BlurView,{contentStyle:{borderRadius:"$3",width:"100%",height:"100%",borderCurve:"continuous"},position:"absolute",intensity:100,top:"$0",left:"$0",right:"$0",bottom:"$0"}),(0,p.jsx)(d.Empty,{icon:"EyeOffOutline",description:e.formatMessage({id:f.ETranslations.address_verify_address_instruction})})]})]}),(0,p.jsx)(d.ConfirmHighlighter,{maxWidth:"$96",highlight:z,mt:"$5",px:"$3",borderRadius:"$3",borderCurve:"continuous",children:(0,p.jsx)(d.SizableText,{textAlign:"center",size:"$bodyMd",style:{wordBreak:"break-all"},children:V?T.address:g.A.shortenAddress({address:T.address})})}),V&&A===x.ForceShow?(0,p.jsxs)(d.XStack,{mt:"$1",justifyContent:"center",alignItems:"center",children:[(0,p.jsx)(d.Icon,{name:"InfoCircleOutline",size:"$4",color:"$iconCritical"}),(0,p.jsx)(d.SizableText,{size:"$bodyMd",color:"$textCritical",pl:"$1.5",children:e.formatMessage({id:f.ETranslations.receive_address_unconfimed_alert_message})})]}):null,O()]}):null}),[T,j,k,_?.showAddressType,I,e,S?.logoURI,B,z,V,A,O,S?.symbol]);return(0,p.jsxs)(d.Page,{children:[(0,p.jsx)(d.Page.Header,{title:e.formatMessage({id:f.ETranslations.global_receive})}),(0,p.jsx)(d.Page.Body,{flex:1,justifyContent:"center",alignItems:"center",px:"$5",pb:"$5",children:P()})]})}}}]);