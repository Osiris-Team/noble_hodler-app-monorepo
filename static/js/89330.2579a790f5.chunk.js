"use strict";(self.webpackChunkweb=self.webpackChunkweb||[]).push([[89330],{304695:(e,t,r)=>{r.d(t,{V:()=>NetworksFilterItem});var n=r(324586),o=r(839850),c=r(17617),i=r(490343),a=r(831085),s=["networkImageUri","networkName","isSelected","tooltipContent","disabled"];function ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(r),!0).forEach((function(t){(0,n.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function NetworksFilterItem(e){var{networkImageUri:t,networkName:r,isSelected:n,tooltipContent:u,disabled:d}=e,l=(0,o.A)(e,s),f=(0,a.jsxs)(i.XStack,_objectSpread(_objectSpread(_objectSpread(_objectSpread({justifyContent:"center",px:"$3",py:"$1.5",borderRadius:"$2",userSelect:"none",borderWidth:c.A.hairlineWidth,borderColor:n?"$borderActive":"$border"},!n&&!d&&{focusable:!0,hoverStyle:{bg:"$bgStrongHover"},pressStyle:{bg:"$bgStrongActive"},focusVisibleStyle:{outlineWidth:2,outlineStyle:"solid",outlineColor:"$focusRing"}}),d&&{opacity:.5}),l),{},{children:[t?(0,a.jsx)(i.Image,{height:"$6",width:"$6",borderRadius:"$full",$gtMd:{height:"$5",width:"$5"},children:(0,a.jsx)(i.Image.Source,{source:{uri:t}})}):null,r?(0,a.jsx)(i.SizableText,{numberOfLines:1,color:n?"$textOnColor":"$textSubdued",size:"$bodyLgMedium",$gtMd:{size:"$bodyMdMedium"},children:r}):null]}));return u?(0,a.jsx)(i.Tooltip,{renderContent:u,placement:"top",renderTrigger:f}):f}},771821:(e,t,r)=>{r.d(t,{v:()=>TokenListItem});var n=r(324586),o=r(839850),c=r(490343),i=r(791088),a=r(491180),s=r(391944),u=r(831085),d=["tokenImageSrc","networkImageSrc","tokenName","isSearch","tokenSymbol","tokenContrastAddress","balance","valueProps","disabled","titleMatchStr","moreComponent"];function ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(r),!0).forEach((function(t){(0,n.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function TokenListItem(e){var t,{tokenImageSrc:r,networkImageSrc:n,tokenName:l,isSearch:f,tokenSymbol:p,tokenContrastAddress:k,balance:w,valueProps:b,disabled:m,titleMatchStr:I,moreComponent:y}=e,S=(0,o.A)(e,d);return(0,u.jsxs)(i.c,_objectSpread(_objectSpread(_objectSpread({userSelect:"none"},f&&{$md:{alignItems:"flex-start"}}),S),{},{children:[(0,u.jsx)(s.o,_objectSpread(_objectSpread({},m&&{opacity:.5}),{},{tokenImageUri:r,networkImageUri:n})),(0,u.jsx)(i.c.Text,_objectSpread(_objectSpread({},m&&{opacity:.5}),{},{flex:1,primary:p,primaryMatch:I,primaryTextProps:{numberOfLines:1},secondary:f?(0,u.jsxs)(c.Stack,{gap:"$0.5",$gtMd:{flexDirection:"row",gap:"$1"},children:[(0,u.jsx)(c.SizableText,{numberOfLines:1,color:"$textSubdued",size:"$bodyMd",children:l}),(0,u.jsx)(c.SizableText,{color:"$textDisabled",size:"$bodyMd",children:a.A.shortenAddress({address:k,leadingLength:8,trailingLength:6})})]}):null!=l?l:""})),(0,u.jsx)(i.c.Text,_objectSpread(_objectSpread({},m&&{opacity:.5}),{},{align:"right",primary:(0,u.jsx)(c.NumberSizeableText,{textAlign:"right",color:"$text",formatter:"balance",size:"$bodyLgMedium",children:w}),secondary:b?.value?(0,u.jsx)(c.NumberSizeableText,{textAlign:"right",size:"$bodyMd",formatter:"value",color:"$textSubdued",formatterOptions:{currency:null!=(t=b?.currency)?t:"$"},children:b.value}):null})),y]}))}},82506:(e,t,r)=>{r.d(t,{d:()=>useDebounce});var n=r(578104);function useDebounce(e,t,r){var[o]=(0,n.d7)(e,t,r);return o}},20322:(e,t,r)=>{r.d(t,{j:()=>useSwapFromAccountNetworkSync,z:()=>useSwapAddressInfo});var n=r(324586),o=r(586330),c=r(712784),i=r.n(c),a=r(514041),s=r(490343),u=r(153763),d=r(259227),l=r(392097),f=r(619390),p=r(317522),k=r(162616),w=r(325529);function ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(r),!0).forEach((function(t){(0,n.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function useSwapFromAccountNetworkSync(){var{updateSelectedAccountNetwork:e}=(0,k.z$)().current,[t]=(0,w.NE)(),{activeAccount:r}=(0,k.LH)({num:1}),[n,c]=(0,w.rv)(),[f]=(0,w.dF)(),[,b]=(0,d.useSettingsAtom)(),[m]=(0,w.Q8)(),I=(0,a.useRef)(),y=(0,a.useRef)(),S=(0,a.useRef)(),g=(0,a.useRef)(n),j=(0,a.useRef)(r);j.current!==r&&(j.current=r),I.current!==t&&(I.current=t),y.current!==m&&(y.current=m),g.current!==n&&(g.current=n),S.current!==f&&(S.current=f);var h,v=(0,a.useCallback)(i()((0,o.A)((function*(){I.current&&(yield e({num:0,networkId:I.current?.networkId})),y.current&&(yield e({num:1,networkId:y.current?.networkId})),I.current&&y.current&&(g.current?.networkId&&y.current?.networkId!==g.current?.networkId||!g.current?.networkId&&!j.current?.account&&j.current?.wallet||!1===S.current)&&(b((function(e){return _objectSpread(_objectSpread({},e),{},{swapToAnotherAccountSwitchOn:!1})})),c((function(e){return _objectSpread(_objectSpread({},e),{},{address:void 0})})),setTimeout((function(){y.current&&e({num:1,networkId:y.current?.networkId})}),500))})),100),[b,e]),A=(0,s.usePageType)();(0,p.A)(l.V4.Swap,(h=(0,o.A)((function*(e,t){if(A!==s.EPageType.modal){if(t)return;e&&(yield v())}})),function(e,t){return h.apply(this,arguments)})),(0,a.useEffect)((function(){A!==s.EPageType.modal&&(0,o.A)((function*(){yield v()}))()}),[v,t,m,f,A]);var O=(0,u.E)();(0,a.useEffect)((function(){A===s.EPageType.modal&&O&&(0,o.A)((function*(){yield v()}))()}),[v,O,A,t,m,f])}function useSwapAddressInfo(e){var{activeAccount:t}=(0,k.LH)({num:e===f.En.FROM?0:1}),[{swapToAnotherAccountSwitchOn:r}]=(0,d.useSettingsAtom)(),[n]=(0,w.rv)();return(0,a.useMemo)((function(){var o={networkId:void 0,address:void 0,accountInfo:void 0};return e===f.En.TO&&r&&n.address&&n.networkId&&t&&t.network?.id===n.networkId?_objectSpread(_objectSpread({},o),{},{address:n.address,networkId:n.networkId,accountInfo:n.accountInfo}):t?_objectSpread(_objectSpread({},o),{},{address:t.account?.address,networkId:t.network?.id,accountInfo:_objectSpread({},t)}):o}),[e,r,n,t])}},866063:(e,t,r)=>{r.d(t,{FI:()=>useSwapInit,GM:()=>useSwapTokenList,ZF:()=>useSwapSelectedTokenInfo});var n=r(503668),o=r.n(n),c=r(324586),i=r(586330),a=r(514041),s=r(241440),u=r(490343),d=r(153763),l=r(259227),f=r(625931),p=r(22937),k=r(392097),w=r(184251),b=r(734818),m=r(58546),I=r(619390),y=r(610421),S=r(317522),g=r(162616),j=r(325529),h=r(20322);function ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(r),!0).forEach((function(t){(0,c.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function useSwapInit(e){var[t,r]=(0,j.ZM)(),[n,c]=(0,j.NE)(),[s,d]=(0,j.Q8)(),[,p]=(0,l.useInAppNotificationAtom)(),{syncNetworksSort:b}=(0,j.eR)().current,v=(0,h.z)(I.En.FROM),{updateSelectedAccountNetwork:A}=(0,g.z$)().current,[O,x]=(0,a.useState)(!0),[T,N]=(0,a.useState)(!1),$=(0,a.useRef)();$.current!==v&&($.current=v);var P=(0,a.useRef)([]);P.current!==t&&(P.current=t);var _=(0,a.useRef)();_.current!==n&&(_.current=n);var E=(0,a.useRef)();E.current!==s&&(E.current=s);var M=(0,a.useCallback)((0,i.A)((function*(){if(t.length)x(!1);else{var e=yield y.A.simpleDb.swapNetworksSort.getRawData();e?.data?.length&&(r(e.data),x(!1));var n=[],o=yield y.A.serviceSwap.fetchSwapNetworks();if(n=[...o],e?.data?.length&&o?.length){var c=e.data;n=c.filter((function(e){return o.find((function(t){return t.networkId===e.networkId}))})).map((function(e){var t=o.find((function(t){return t.networkId===e.networkId}));return _objectSpread(_objectSpread({},e),t)})).concat(o.filter((function(e){return!c.find((function(t){return t.networkId===e.networkId}))})))}n.length&&(yield y.A.simpleDb.swapNetworksSort.setRawData({data:n}),e?.data?.length&&e?.data?.length===n.length||(r(n),x(!1)))}})),[r,t.length]),R=(0,a.useCallback)((0,i.A)((function*(){if(!_.current&&!E.current){var t,r;if(e?.importFromToken&&P.current.find((function(t){return t.networkId===e?.importFromToken?.networkId}))||e?.importToToken&&P.current.find((function(t){return t.networkId===e?.importFromToken?.networkId})))return c(e.importFromToken),d(e.importToToken),void b(null!=(t=null!=(r=e.importFromToken?.networkId)?r:e.importToToken?.networkId)?t:(0,f.V)().onekeyall);if($.current?.accountInfo?.ready&&$.current?.networkId&&P.current.length&&(!e?.importNetworkId||!$.current?.networkId||e?.importNetworkId===$.current?.networkId)&&!T){var n=P.current.find((function(e){return e.networkId===$.current?.networkId})),i=w.A.isAllNetwork({networkId:$.current?.networkId}),a=n,s=n?.networkId;if(i&&(s=(0,f.V)().onekeyall,a=P.current.find((function(e){return"evm--1"===e.networkId}))),a&&s&&(!o()(m.TW[s]?.fromToken)||!o()(m.TW[s]?.toToken))){var u=m.TW[s]?.fromToken,l=m.TW[s]?.toToken;u&&(c(_objectSpread(_objectSpread({},u),{},{networkLogoURI:a?.logoURI})),b(u.networkId)),l&&(d(_objectSpread(_objectSpread({},l),{},{networkLogoURI:a?.logoURI})),b(l.networkId))}}}})),[e?.importFromToken,e?.importNetworkId,e?.importToToken,c,d,T,b]);(0,a.useEffect)((function(){(0,i.A)((function*(){var e=yield y.A.simpleDb.swapConfigs.getRecentTokenPairs();p((function(t){return _objectSpread(_objectSpread({},t),{},{swapRecentTokenPairs:e})}))}))()}),[p]),(0,a.useEffect)((function(){(0,i.A)((function*(){yield M()}))()}),[M,t.length]),(0,a.useEffect)((function(){(0,i.A)((function*(){e?.importNetworkId&&$.current?.networkId&&e.importNetworkId!==$.current.networkId&&(yield A({num:0,networkId:e.importNetworkId}))}))()}),[e?.importNetworkId,A]),(0,a.useEffect)((function(){(0,i.A)((function*(){yield R()}))()}),[v.accountInfo?.ready,t.length,v.networkId,e?.importFromToken,e?.importToToken,e?.importNetworkId]);var C=(0,u.usePageType)();return(0,S.A)(k.V4.Swap,(function(e,t){C!==u.EPageType.modal&&e&&N(!!t)})),{fetchLoading:O}}function useSwapTokenList(e,t,r){var[n,o]=(0,a.useState)([]),[{tokenCatch:c}]=(0,j.PQ)(),[i]=(0,j.Yb)(),[u]=(0,j.ZM)(),{tokenListFetchAction:d,swapLoadAllNetworkTokenList:l}=(0,j.eR)().current,f=(0,h.z)(e),[k]=(0,j.Hb)(),m=(0,a.useMemo)((function(){return{networkId:t,keywords:r,accountAddress:f?.address,accountNetworkId:f?.networkId,accountId:f?.accountInfo?.account?.id}}),[t,r,f?.address,f?.networkId,f?.accountInfo?.account]),I=(0,a.useMemo)((function(){var e,t,r;return i[null!=(e=null!=(t=null!=(r=f?.accountInfo?.indexedAccount?.id)?r:f?.accountInfo?.account?.id)?t:f?.accountInfo?.dbAccount?.id)?e:"noAccountId"]}),[i,f?.accountInfo?.indexedAccount?.id,f?.accountInfo?.account?.id,f?.accountInfo?.dbAccount?.id]),y=(0,a.useCallback)((function(e){var t=e.filter((function(e){var t,r=new s.A(null!=(t=e.price)?t:"0");return!r.isNaN()&&!r.isZero()}))?.sort((function(e,t){var r,n,o=new s.A(null!=(r=e.fiatValue)?r:"0");return new s.A(null!=(n=t.fiatValue)?n:"0").comparedTo(o)})),r=e.filter((function(e){var t,r=new s.A(null!=(t=e.price)?t:"0");return r.isNaN()||r.isZero()}))?.sort((function(e,t){var r,n,o=new s.A(null!=(r=e.fiatValue)?r:"0");return new s.A(null!=(n=t.fiatValue)?n:"0").comparedTo(o)}));return[...t,...r]}),[]),S=(0,a.useCallback)((function({swapAllNetRecommend:e,swapSearchTokens:t}){var r,n;if(e?.length&&!I)return[];var o=null!=(r=I?.map((function(e){var t=u.find((function(t){return t.networkId===e.networkId}));return t?_objectSpread(_objectSpread({},e),{},{networkLogoURI:t.logoURI}):e}))?.filter((function(e){return u.find((function(t){return t.networkId===e.networkId}))})))?r:[],c=null!=(n=o?.filter((function(e){var t,r=new s.A(null!=(t=e?.balanceParsed)?t:"0");return!r.isNaN()&&!r.isZero()})))?n:[];if(e){var i,a=null!=(i=e?.filter((function(e){return!c?.find((function(t){return(0,b.BQ)({token1:{networkId:t?.networkId,contractAddress:t?.contractAddress},token2:{networkId:e?.networkId,contractAddress:e?.contractAddress}})}))})))?i:[],d=[...c,...a];return y(null!=d?d:[])}if(t){var l=t.map((function(e){if(u.find((function(t){return t.networkId===e.networkId}))){var t=c.find((function(t){return t?.contractAddress===e?.contractAddress&&t?.networkId===e?.networkId}));return t||e}})).filter((function(e){return e}));return y(null!=l?l:[])}return[]}),[y,I,u]),g=(0,p.bJ)(w.A.isAllNetwork({networkId:m.networkId})&&r?S({swapSearchTokens:c?.[JSON.stringify(m)]?.data||[]}):c?.[JSON.stringify(m)]?.data||[],{shouldSort:!1,keys:["symbol","contractAddress"]}),v=(0,a.useRef)(g);return v.current!==g&&(v.current=g),(0,a.useEffect)((function(){if(!m.accountNetworkId||m.networkId===m.accountNetworkId||w.A.isAllNetwork({networkId:m.networkId})){var e;if(m.networkId&&!r&&w.A.isAllNetwork({networkId:m.networkId}))l(m.networkId,f?.accountInfo?.indexedAccount?.id,f?.accountInfo?.indexedAccount?.id?void 0:null!=(e=f?.accountInfo?.account?.id)?e:f?.accountInfo?.dbAccount?.id);d(m)}}),[f?.accountInfo?.account?.id,f?.accountInfo?.dbAccount?.id,f?.accountInfo?.indexedAccount?.id,l,m,d,r]),(0,a.useEffect)((function(){m.accountNetworkId&&m.networkId!==m.accountNetworkId&&!w.A.isAllNetwork({networkId:m.networkId})||(r&&v.current?o(v.current.search(r)):o(w.A.isAllNetwork({networkId:m.networkId})?S({swapAllNetRecommend:c?.[JSON.stringify(m)]?.data||[]}):c?.[JSON.stringify(m)]?.data||[]))}),[c,m,t,r,S]),{fetchLoading:k&&0===n.length||w.A.isAllNetwork({networkId:m.networkId})&&!I,currentTokens:n}}function useSwapSelectedTokenInfo({token:e,type:t}){var r=(0,h.z)(t),[n,o]=(0,a.useState)(0),[{swapHistoryPendingList:c}]=(0,l.useInAppNotificationAtom)(),{loadSwapSelectTokenDetail:i}=(0,j.eR)().current,s=(0,a.useRef)(c);s.current!==c&&(s.current=c);var f=(0,a.useRef)(n);f.current!==n&&(f.current=n);var p=(0,a.useRef)(r);p.current!==r&&(p.current=r);var w=(0,d.E)(),b=(0,a.useRef)(w);b.current!==w&&(b.current=w),(0,a.useEffect)((function(){if(b.current&&c.length){var e=c.filter((function(e){return e.status===I.lr.SUCCESS})).length;e>f.current&&(i(t,p.current,!0),o(e))}}),[i,c,t]),(0,a.useEffect)((function(){i(t,p.current,!e?.reservationValue&&e?.isNative)}),[t,r,e?.networkId,e?.contractAddress,i,e?.reservationValue,e?.isNative]);var m=(0,u.usePageType)();(0,S.A)(k.V4.Swap,(function(e,r){if(m!==u.EPageType.modal&&e&&!r&&s.current.length){var n=s.current.filter((function(e){return e.status===I.lr.SUCCESS})).length;n>f.current&&(i(t,p.current,!0),o(n))}}))}},309008:(e,t,r)=>{r.d(t,{o:()=>d});var n=r(324586),o=r(514041),c=r(325529),i=r(2577),a=r(597102),s=r(829561),u=r(831085);function ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(r),!0).forEach((function(t){(0,n.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var d=(0,o.memo)((function(e){var{children:t,storeName:r}=e,n=(0,s.x6)(r),o=i.A.getOrCreateStore(n);return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(a.H,_objectSpread({},n)),(0,u.jsx)(c.BY,{store:o,children:t})]})}));d.displayName="SwapProviderMirror"},89330:(e,t,r)=>{r.r(t),r.d(t,{default:()=>SwapTokenSelectModal});var n=r(324586),o=r(586330),c=r(514041),i=r(654266),a=r(241440),s=r(908867),u=r(490343),d=r(610421),l=r(325809),f=r(791088),p=r(771821),k=r(498356),w=r(82506),b=r(162616),m=r(325529),I=r(259227),y=r(625931),S=r(254491),g=r(663522),j=r(628380),h=r(491180),v=r(117746),A=r(734818),O=r(714191),x=r(58546),T=r(619390),N=r(885127),$=r(812715),P=r(304695),_=r(831085);const E=(0,c.memo)((function({networks:e,selectedNetwork:t,onSelectNetwork:r,moreNetworksCount:n,onMoreNetwork:o}){var{width:i}=(0,$.A)(),a=i>380,s=(0,c.useMemo)((function(){return a?e:e.slice(0,4)}),[e,a]);return(0,_.jsxs)(u.XStack,{px:"$5",pt:"$1",pb:"$3",gap:"$2",children:[s.map((function(e){var n,o,c;return(0,_.jsx)(P.V,{networkImageUri:e.logoURI,tooltipContent:null!=(n=null!=(o=null!=(c=e.name)?c:e.symbol)?o:e.shortcode)?n:"Unknown",isSelected:e?.networkId===t?.networkId,onPress:function(){r(e)}},e.networkId)})),n&&n>0?(0,_.jsx)(P.V,{networkName:`${n}+`,flex:1,onPress:o}):null]})}));var M=r(17617);const R=(0,c.memo)((function({onSelectToken:e,selectedToken:t,tokens:r}){return(0,_.jsx)(u.XStack,{pt:"$1",pb:"$3",gap:"$1.5",flexWrap:"wrap",children:r.map((function(r){return(0,_.jsxs)(u.XStack,{role:"button",userSelect:"none",alignItems:"center",px:"$1.5",py:"$1",bg:"$bg",borderRadius:"$4",borderWidth:M.A.hairlineWidth,borderColor:"$borderSubdued",hoverStyle:{bg:"$bgHover"},pressStyle:{bg:"$bgActive"},focusable:!0,focusVisibleStyle:{outlineColor:"$focusRing",outlineStyle:"solid",outlineWidth:2,outlineOffset:2},disabled:!!(0,A.BQ)({token1:t,token2:r}),onPress:function(){e(r)},disabledStyle:{opacity:.5},children:[(0,_.jsx)(u.Image,{height:"$4.5",width:"$4.5",borderRadius:"$full",children:(0,_.jsx)(u.Image.Source,{source:{uri:r.logoURI}})}),(0,_.jsx)(u.SizableText,{pl:"$1",size:"$bodyLgMedium",children:r.symbol})]},r.contractAddress)}))})}));var C=r(20322),D=r(866063),L=r(309008);function ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(r),!0).forEach((function(t){(0,n.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var SwapTokenSelectPage=function(){var e,t,r,n=(0,k.A)(),l=(0,i.lq)(),O=(0,c.useMemo)((function(){var e;return null!=(e=l.params?.type)?e:T.En.FROM}),[l.params?.type]),$=(0,s.A)(),[P,M]=(0,c.useState)(""),L=(0,w.d)(P,500),[F]=(0,m.ZM)(),[z]=(0,m.qv)(),[U]=(0,m.NE)(),V=(0,C.z)(T.En.FROM),K=(0,C.z)(T.En.TO),[B]=(0,m.Q8)(),[Z]=(0,I.useSettingsPersistAtom)(),{selectFromToken:W,selectToToken:H,syncNetworksSort:Q}=(0,m.eR)().current,{updateSelectedAccountNetwork:Y}=(0,b.z$)().current,X=(0,c.useCallback)((function(){var e;if(O===T.En.FROM){if(U?.networkId)return null!=(e=z.find((function(e){return e.networkId===U.networkId})))?e:z?.[0]}else if(B?.networkId){var t;return null!=(t=z.find((function(e){return e.networkId===B.networkId})))?t:z?.[0]}return z?.[0]}),[U?.networkId,z,B?.networkId,O]),[J,q]=(0,c.useState)(X),G=(0,c.useRef)(null);(0,c.useEffect)((function(){var e=O===T.En.FROM?V.networkId:K.networkId;J?.networkId&&J?.networkId!==e&&Y({num:O===T.En.FROM?0:1,networkId:J?.networkId})}),[]);var ee,te,{fetchLoading:re,currentTokens:ne}=(0,D.GM)(O,J?.networkId,L),oe=(0,c.useMemo)((function(){return ne.findIndex((function(e){var t=e.item?e.item:e;return!t.price||new a.A(t.price).isZero()}))}),[ne]),ce=(0,c.useCallback)((ee=(0,o.A)((function*(e){var t=!e.isPopular&&(!e.price||new a.A(e.price).isZero()||e.riskLevel===T.eU.SPAM||e.riskLevel===T.eU.MALICIOUS);return t?!!Z.tokenRiskReminder&&!(yield d.A.serviceSetting.checkConfirmedRiskToken(`${e.networkId}_${e.contractAddress}`)):t})),function(e){return ee.apply(this,arguments)}),[Z.tokenRiskReminder]),ie=(0,c.useCallback)((function(e){n.popStack(),O===T.En.FROM?W(e):H(e)}),[n,W,H,O]),ae=(0,c.useCallback)((te=(0,o.A)((function*(e){(yield ce(e))?n.push(j.u.TokenRiskReminder,{storeName:l.params.storeName,token:e,onConfirm:function(){ie(e)}}):ie(e)})),function(e){return te.apply(this,arguments)}),[ce,n,l.params.storeName,ie]),se=(0,c.useCallback)((function(e){q(e),e.networkId!==(0,y.V)().onekeyall&&Y({num:O===T.En.FROM?0:1,networkId:e.networkId}),G.current?.scrollToOffset({offset:0,animated:!1})}),[O,Y]),ue=(0,c.useCallback)((function(e){return(0,A.BQ)({token1:{networkId:O===T.En.FROM?B?.networkId:U?.networkId,contractAddress:O===T.En.FROM?B?.contractAddress:U?.contractAddress},token2:{networkId:e.networkId,contractAddress:e.contractAddress}})}),[U?.contractAddress,U?.networkId,B?.contractAddress,B?.networkId,O]),{md:de}=(0,u.useMedia)(),{copyText:le}=(0,u.useClipboard)(),fe=(0,c.useCallback)((function({item:e,index:t}){var r,n,c,i,s=e.item?e.item:e,l=new a.A(null!=(r=s.balanceParsed)?r:0),f=new a.A(null!=(n=s.fiatValue)?n:0),k=de?h.A.shortenAddress({address:s.contractAddress}):s.contractAddress,w={isSearch:!!L,tokenImageSrc:s.logoURI,tokenName:s.name,tokenSymbol:s.symbol,networkImageSrc:s.networkLogoURI,tokenContrastAddress:L?k:void 0,balance:l.isZero()?void 0:s.balanceParsed,valueProps:s.fiatValue&&!f.isZero()?{value:s.fiatValue,currency:Z.currencyInfo.symbol}:void 0,onPress:ue(s)?void 0:function(){return ae(s)},disabled:ue(s),titleMatchStr:e.matches?.find((function(e){return"symbol"===e.key}))};return(0,_.jsxs)(_.Fragment,{children:[oe===t?(0,_.jsx)(u.Stack,{pt:"$3",pb:"$2",children:(0,_.jsx)(u.Alert,{fullBleed:!0,type:"default",title:$.formatMessage({id:S.ETranslations.token_selector_unverified_token_warning}),icon:"InfoCircleOutline"})}):null,(0,_.jsx)(p.v,_objectSpread(_objectSpread({},w),{},{moreComponent:(0,_.jsx)(u.ActionList,{title:null!=(c=w.tokenSymbol)?c:"",renderTrigger:(0,_.jsx)(u.IconButton,{variant:"tertiary",icon:"DotVerSolid"}),items:[{icon:"Copy3Outline",label:$.formatMessage({id:S.ETranslations.global_copy_address}),onPress:function(){le(s.contractAddress)},disabled:s.isNative},{icon:"OpenOutline",label:$.formatMessage({id:S.ETranslations.swap_token_selector_contract_info}),onPress:(i=(0,o.A)((function*(){var e=yield d.A.serviceExplorer.buildExplorerUrl({networkId:s.networkId,type:"token",param:s.contractAddress});(0,v.Dr)(e)})),function onPress(){return i.apply(this,arguments)}),disabled:s.isNative}]})}))]})}),[oe,le,$,de,ae,ue,L,Z.currencyInfo.symbol]),pe=(0,c.useMemo)((function(){var e,t=[];return z&&z.length&&(de?(t=z.length>x.ck?z.slice(0,x.ck):z,e=z.length-x.ck>0?z.length-x.ck:void 0):(t=z.length>x.BT?z.slice(0,x.BT):z,e=z.length-x.BT>0?z.length-x.BT:void 0)),{swapNetworksCommon:t,swapNetworksMoreCount:e}}),[de,z]),ke=(0,N.A)(),{bottom:we}=(0,u.useSafeAreaInsets)(),be=(0,c.useMemo)((function(){var e;return J?.networkId&&null!=(e=x.hm[J?.networkId])?e:[]}),[J?.networkId]);return(0,_.jsxs)(u.Page,{skipLoading:g.Ay.isNativeIOS,safeAreaEnabled:!1,children:[(0,_.jsx)(u.Page.Header,{title:$.formatMessage({id:S.ETranslations.token_selector_title}),headerSearchBarOptions:{placeholder:$.formatMessage({id:S.ETranslations.token_selector_search_placeholder}),onChangeText:function({nativeEvent:e}){var t=e.text.trim();M(t)}}}),(0,_.jsxs)(u.Page.Body,{children:[(0,_.jsxs)(u.XStack,{px:"$5",pb:"$2",children:[(0,_.jsx)(u.SizableText,{size:"$bodyMd",color:"$textSubdued",pr:"$2",children:`${$.formatMessage({id:S.ETranslations.token_selector_network})}`}),(0,_.jsx)(u.XStack,{children:(0,_.jsx)(u.SizableText,{size:"$bodyMd",children:null!=(e=null!=(t=null!=(r=J?.name)?r:J?.symbol)?t:J?.shortcode)?e:"Unknown"})})]}),(0,_.jsx)(E,{onMoreNetwork:function(){ke({defaultNetworkId:J?.networkId,networkIds:F.map((function(e){return e.networkId})),grouped:!1,onSelect:function(e){if(e){var t=F.find((function(t){return t.networkId===e.id}));t&&(se(t),Q(t.networkId))}}})},networks:pe.swapNetworksCommon,moreNetworksCount:pe.swapNetworksMoreCount,selectedNetwork:J,onSelectNetwork:se}),(0,_.jsx)(u.Divider,{mt:"$2"}),(0,_.jsx)(u.YStack,{flex:1,children:(0,_.jsx)(u.ListView,{ref:G,data:ne,renderItem:fe,estimatedItemSize:60,ListHeaderComponent:be.length>0&&!L?(0,_.jsxs)(u.YStack,{px:"$5",pt:"$3",gap:"$2",children:[(0,_.jsx)(u.SizableText,{size:"$bodyMd",color:"$textSubdued",pr:"$2",children:`${$.formatMessage({id:S.ETranslations.swap_token_selector_popular_token})}`}),(0,_.jsx)(R,{onSelectToken:ae,selectedToken:O===T.En.FROM?B:U,tokens:be})]}):null,ListFooterComponent:(0,_.jsx)(u.Stack,{h:we||"$2"}),ListEmptyComponent:re?(0,_.jsx)(_.Fragment,{children:Array.from({length:5}).map((function(e,t){return(0,_.jsxs)(f.c,{children:[(0,_.jsx)(u.Skeleton,{w:"$10",h:"$10",radius:"round"}),(0,_.jsxs)(u.YStack,{children:[(0,_.jsx)(u.YStack,{py:"$1",children:(0,_.jsx)(u.Skeleton,{h:"$4",w:"$32"})}),(0,_.jsx)(u.YStack,{py:"$1",children:(0,_.jsx)(u.Skeleton,{h:"$3",w:"$24"})})]})]},t)}))}):(0,_.jsx)(u.Empty,{icon:"SearchOutline",title:$.formatMessage({id:S.ETranslations.global_no_results}),description:$.formatMessage({id:S.ETranslations.token_no_search_results_desc})})})})]})]})},SwapTokenSelectPageWithProvider=function(){var e=(0,i.lq)(),{storeName:t}=e.params;return(0,_.jsx)(L.o,{storeName:t,children:(0,_.jsx)(SwapTokenSelectPage,{})})};function SwapTokenSelectModal(){return(0,_.jsx)(l.b8,{config:{sceneName:O.Zs.swap},enabledNum:[0,1],children:(0,_.jsx)(SwapTokenSelectPageWithProvider,{})})}}}]);